
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">
@import url(http://fonts.googleapis.com/earlyaccess/notosansjapanese.css);
body { counter-reset: sheet; /* カウンタの初期化 */ font-family: 'Noto Sans Japanese', sans-serif; }
@media print {
a[href]:after { content: "" !important; }
abbr[title]:after { content: "" !important; }
}
img { border: none; }
a img { border: none; }
.clearfix:after { content: "."; display: block; height: 0; clear: both; visibility: hidden; }
.clearfix { display: inline-table; }
.sheet { width: 297mm; height: 189mm; /* 1mm余裕をもたせる */ page-break-after: always; position: relative; }
.sheet.commercial { page-break-after: avoid; }
img { max-width: 277mm; height: auto; }
.build_title { margin-top: 10px; margin-bottom: 10px; font-size: 20px; }
.cover h1 { font-size: 30px; padding-top: 50mm; margin-top: 0; }
.cover h4 { margin-bottom: 1mm; margin-top: 0; }
.cover h4.en { font-family: HelveticaNeue-UltraLight; font-weight: 100; }
.client { font-size: 11pt; font-weight: bold; padding-left: 5mm; position: relative; padding-bottom: 2mm; }
.client:before { position: absolute; width: 1px; height: 12mm; top: 0; left: 0; background: #000; content: ""; }
.client:after { position: absolute; width: 282mm; height: 2px; bottom: 0; left: -5mm; background: #000; content: ""; }
.author { background: #d52b2b; padding: 5mm; }
.author p { margin-top: 0; font-size: 10pt; margin-bottom: 2mm; }
.author p.date { margin-top: 5mm; }
.author { background: #e11b30; padding: 8mm 5mm; position: absolute; bottom: 5mm; width: 267mm; }
.author p.name { font-size: 20pt; font-weight: bold; }
.author p.company_name { font-size: 16pt; margin-bottom: 3mm; font-weight: bold; }
.author p { line-height: 1.2; }
.route-map { width: 277mm; height: auto; }
.notice { padding-top: 5mm; width: 277mm; }
.half { width: 50%; float: left; }
.notice p { font-size: 4pt; margin: 0; }
table { border-collapse: collapse; }
table.building-profile { width: 277mm; }
td.center { text-align: center; }
td.right-align { text-align: right; }
th.building-name { width: 110mm; }
th.building-addr { width: 80mm; }
table.building-profile { border-collapse: collapse; }
table.building-profile th { border-bottom: 1px solid #000; font-size: 11pt; font-weight: normal; padding-top: 8mm; }
table.building-profile td { font-size: 11pt; border-bottom: 1px solid #c9c9c9; line-height: 7mm; height: 7mm; }
caption { background: #e11b30; color: #000; text-transform: uppercase; padding: 1mm 0; font-family: HelveticaNeue-bold; }
table.single-info td.title { font-size: 24pt; }
table.building-profile.single-info td { height: auto; line-height: 1.6; border: none; }
table.building-profile.single-info th { border-color: #c9c9c9; }
table.building-profile.single-info td table caption { text-align: left; background: none; color: #e11b30; font-weight: bold; border-left: 4px solid #e11b30; padding: 0; text-indent: 2mm; line-height: 1.2; font-size: 9pt; }
table.building-profile.single-info td table td, table.building-profile.single-info td table th { font-size: 8pt; line-height: 1; height: 4mm; padding: 0; }
table.building-profile.single-info td table th { padding: 2mm 0 1mm; }
table.building-profile.single-info td table td.notes { line-height: 1.4; }
td.td_col1_3 { width: 25%; vertical-align: top; }
td.td_col2_3 { width: 75%; }
td.td_col2_3 { padding: 0 0 0 10mm; vertical-align: top; }
td.td_col2_3 table { width: 100%; }
td.td_col1_3 img { width: 100%; }
table.building-profile.single-info td table.current_status tr:nth-child(odd) td { background-color: #ffffff; }
table.building-profile.single-info td table.current_status tr:nth-child(even) td { background-color: #f4f4f4; }
table.building-profile.single-info th { padding-top: 2mm; }
table.building-profile.single-info td table td.total { padding-left: 3mm; }
td.var-top { vertical-align: top; }
table.building-profile.single-info td.space-empty { height: 5mm; }
td.plan-img img { width: 100%; }
table.building-profile.single-info td table.summary td, table.building-profile.single-info td table.summary th { font-size: 8pt; border: none; text-align: left; padding: 0; line-height: 1.6; }
table.building-profile.single-info td table.summary.time-to-use td { font-size: 6pt; line-height: 1; }
table.building-profile.single-info td table td.pad-left { padding-left: 5mm; }
table.building-profile.single-info td table.summary th { width: 21mm; }
table.building-profile.single-info td table.summary caption { margin-bottom: 1mm; }
table.building-details { margin-top: 3mm; }
table.building-profile.single-info td.title { border-top: 5px solid #e11b30; }
table.summary.building-summary { margin-bottom: 4mm; }
table.summary.time-to-use { margin-bottom: 10mm; }
/*printout ver2*/

table.building-list { width: 100%; }
table.building-list th { font-size: 5pt; line-height: 1.1; background: #e11b30; padding: 2mm 0; }
table.building-list td { font-size: 7pt; border-right: 1px solid #CCC; line-height: 1.2; }
th.label_1 { width: 8mm; }
th.label_2 { width: 70mm; }
th.label_9 { width: 55mm; }
th.label_10 { width: 30mm; }
td.build_img img { width: 100%; }
table.building-list td table td { height: 5mm; line-height: 1.2; border: none; padding: 0 1mm; }
table.building-list td table td.build_name { height: 10.3mm; font-size: 11pt; border-bottom: 1px solid #CCC; }
table.building-list td table td.build_name span.build_no { text-align: right; font-size: 5pt; display: block; }
table.building-list td table td.build_name, table.building-list td table td.build_no { background: #efefef; }
table.building-list td table { width: 100%; }
td.summary_td { padding: 0; vertical-align: top; }
table.building-list td table.lists td { padding: 0; }
.label_3 { width: 11mm; }
.label_4, .label_5, .label_6, .label_7 { width: 22mm; }
td.label_4, td.label_5, td.label_6, td.label_7 { text-align: right; }
table.lists tr:nth-child(even) td { background-color: #f4f4f4; }
table.lists tr.row_second td, table.building-list td table.lists td.center.label_3 { border-bottom: 1px solid #CCC; }
table.building-list td table.lists td.center.label_3 { border-right: 1px solid #CCC; }
table.building-list td table.facility-info td { border-bottom: 1px solid #CCC; }
/*table.lists tr:nth-child(odd) td {

    border-bottom: 1px solid #ffffff;

}*/
table.facility-info td.comment-texts { font-size: 5pt !important; height: auto; line-height: 1.4; }
td.no-border { border: none !important; }
.building-list tr { border-bottom: 2px solid #CCC; border-left: 1px solid #CCC; }
.building-list tr table tr, .building-list tr.tr-th { border: none; }
/*****ver3***********/

.commercial table { width: 100%; }
td.cam_date { width: 20mm; }
th.bo_name { width: 180mm; }
th.bo_fee { width: 12mm; }
th.bo_upd { width: 21mm; }
td.f_emp { width: 20mm; }
td.f_price_m_shiki { width: 7mm; }
td.f_price_t_rent { width: 14mm; }
td.f_price_a_rent { width: 17mm; }
td.f_price_t_mente { width: 13mm; }
td.f_acreg_str { width: 13mm; }
td.f_price_rerent { width: 10mm; }
td.f_price_amo_str, td.f_price_keymoney_str, td.f_oa { width: 11mm; }
td.f_purpose1, td.f_purpose2, td.f_purpose3, td.f_purpose4, td.f_purpose8 { width: 8mm; }
td.f_floor_str { width: 10mm; }
table.f_info { background: #f4f4f4; border-top: 1px solid #CCC; margin-bottom: 5mm; }
section.sheet.commercial table td, section.sheet.commercial table th { font-size: 8pt; line-height: 1.8; text-align: left; font-weight: normal; }
table.bd_data { border-bottom: 1px solid #e11b30; border-top: 3px solid #e11b30; }
table.b_info.br { border-bottom: 1px solid #e9e9e9; }
span.owner_type { border: 1px solid #000; padding: 2px; line-height: 1; display: inline-block; margin-right: 5px; }
section.sheet.commercial table.b_data td, section.sheet.commercial table.b_data th { line-height: 2.1; }
p.last_update { margin: 0; padding: 2px 0; font-size: 7pt; text-align: right; border-top: 1px solid #e9e9e9; border-bottom: 1px solid #e9e9e9; }
table.f_info tr { border-bottom: 1px solid #CCC; }
/* プレビュー用のスタイル */
@media screen {
body { background: #eee; }
.sheet { background: white; /* 背景を白く */ background: #ffffff; box-shadow: 0 .5mm 2mm rgba(0,0,0,.3); /* ドロップシャドウ */ margin: 5mm; padding: 10mm; width: 277mm; height: 189mm; }
}
@page { size: A4 landscape; margin: 10mm; }
@media print {
body { width: 277mm; /* needed for Chrome */ }
.sheet.commercial { height: auto !important; }
}
</style>
<page>
<?php
/********** get google map api key **********/
$criteria=new CDbCriteria;
$criteria->order='google_map_api_key_id DESC';

$getGoogleMapKeyDetails = GoogleMapApiKey::model()->find($criteria);
$gApiKey = '';
if(count($getGoogleMapKeyDetails) > 0){
	$gApiKey = $getGoogleMapKeyDetails['api_key'];
}
/***************** end ****************/
?>
<?php
if($requestData['print_type'] == 10){
	if(isset($requestData['add_cover']) && $requestData['add_cover'] == 1) {
?>
	<section class="sheet cover" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
		<div class="client" style="font-size: 11pt; font-weight: bold; padding-left: 5mm; position: relative; padding-bottom: 2mm;">
			<?php
				$prosalData = ProposedArticle::model()->findByPK($requestData['hdnProArticleId']);
				$companyName = Customer::model()->findByPk($prosalData['customer_id']);
				echo $companyName['company_name'];
			?>
		</div>
		<!--client company name-->
		<h1><?php echo $requestData['header_name']; ?></h1>
		
		<!--title of article *editable-->
		<h4 class="subtitle">オフィスビルご紹介資料</h4>
		<!--common sub title-->
		<h4 class="subtitle en"><?php echo Yii::app()->controller->__trans('office building information'); ?></h4>
		<!--common sub title-->
		<div class="author">
			<p class="company_name">株式会社 <?php echo Yii::app()->controller->__trans('Japan Properties'); ?></p>
			<!--author company name *common-->
			<p class="address">〒106-0032 東京都港区六本木5-9-20　六本木イグノポール5階</p>
			<!--author company address *common-->
			<p class="tel">03-5411-7500</p>
			<!--author company tel *common-->
			<p class="email">info@properties.co.jp</p>
			<!--author company email *common-->
			<p class="date"><?php echo  date('Y.m.d'); ?></p>
			<!--author date to publish -->
		</div>
	</section>
	<?php } ?>
	<?php if(isset($requestData['print_route']) && $requestData['print_route'] == 1) {?>
	<div class="client" style="font-size: 11pt; font-weight: bold; padding-left: 5mm; position: relative; padding-bottom: 2mm;"></div>
	<section class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
		<img src="images/route-map-sample.jpg" class="route-map"><!--image of route map-->
		<div class="notice clearfix">
			<div class="half left">
				<p>※契約面積・金額が㎡表示の物件は坪に換算しています。(坪換算値=3.3058)。</p>
				<!--fixed texts-->
				<p>※賃貸条件や建物設備は変更する可能性があります。正式な内容につきましては重要事項説明書をもってご説明致します。</p>
				<!--fixed texts-->
				<p>※ご紹介致しました物件が既に商談又は決定済みの節はご了承の程お願い申し上げます。</p>
				<!--fixed texts-->
				<p>※賃料等課税対象となる金額には別途消費税が加算されます。</p>
				<!--fixed texts-->
			</div>
			<div class="half right">
				<p>※共用率はワンフロア当りです。</p>
				<!--fixed texts-->
				<p>※(案)の表示階は、分割例とします。</p>
				<!--fixed texts-->
				<p>※★マークは想定価格を表しています。</p>
				<!--fixed texts-->
				<p>※契約が成立した場合仲介手数料として賃料の１カ月分を申し受けます。</p>
				<!--fixed texts-->
			</div>
		</div>
	</section>
	<?php }?>
	<!--<td colspan="2" class="title">AAA Building</td><!--one of building name--> 
	<!--<td class="td_col1_3"><img src="images/aaa_building.jpg" /></td><!--one of building main image-->
	<section class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
		<table class="building-list">
			<tr class="tr-th">
				<th class="label_1">
					<?php echo Yii::app()->controller->__trans('Map'); ?><br/>
					No.
				</th><!--fixed texts-->
				<th class="label_2">ビル概要</th><!--fixed texts-->
				<th class="label_3">募集階</th><!--fixed texts-->
				<th class="label_4">面積(坪)<br/>(<?php echo Yii::app()->controller->__trans('m'); ?>&sup2;)</th>
				<!--fixed texts-->
				<th class="label_5">賃料(坪単価)<br/>総額</th><!--fixed texts-->
				<th class="label_6">共益費(坪単価)<br/>総額</th><!--fixed texts-->
				<th class="label_7">預託金<br/>総額</th><!--fixed texts-->
				<th class="label_8">入居可能日</th><!--fixed texts-->
				<th class="label_9">設備概要</th><!--fixed texts-->
				<th class="label_10">ビル外観</th><!--fixed texts-->
			</tr>
			<?php
			if(isset($buildCartDetails) && count($buildCartDetails) > 0){
				$user = Users::model()->findByAttributes(array('username'=>Yii::app()->user->getId()));
				$logged_user_id = $user->user_id;
				$buildingNumber = 1;
				$indexFloor = 0;
				foreach($buildCartDetails as $buildCart){
			?>
			<tr>
				<td class="center">No.<?php echo $buildingNumber; ?></td>
				<?php include('_print_summary.php');?>
				<td colspan="6" class="list_floor var-top">
					<table class="lists">
						<?php
							$floorDetails = Floor::model()->findAll('building_id = '.$buildCart['building_id'].' And vacancy_info = 1' );
							
// 							for ($j=0; $j<20; $j++) {
// 								$floorDetails[] = $floorDetails[0];
// 							}
							
							foreach($floorDetails as $floor){
								$indexFloor ++;
								$floorId = Floor::model()->findByPk($floor['floor_id']);
								if($indexFloor && ($indexFloor % 18 == 0 )) {
									echo '</table></td>';
									include('_print_facility_summary.php');
									echo '</tr></table></section>
										<section class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
											<table class="building-list">
												<tr class="tr-th">
														<th class="label_1">
															'. Yii::app()->controller->__trans("Map") .'<br/>
															No.
														</th><!--fixed texts-->
														<th class="label_2">ビル概要</th><!--fixed texts-->
														<th class="label_3">募集階</th><!--fixed texts-->
														<th class="label_4">面積(坪)<br/>('. Yii::app()->controller->__trans("m") .'&sup2;)</th>
														<!--fixed texts-->
														<th class="label_5">賃料(坪単価)<br/>総額</th><!--fixed texts-->
														<th class="label_6">共益費(坪単価)<br/>総額</th><!--fixed texts-->
														<th class="label_7">預託金<br/>総額</th><!--fixed texts-->
														<th class="label_8">入居可能日</th><!--fixed texts-->
														<th class="label_9">設備概要</th><!--fixed texts-->
														<th class="label_10">ビル外観</th><!--fixed texts-->
													</tr>
												<tr><td class="center">No.'. $buildingNumber .'</td></td>';
									include('_print_summary.php');
									echo '<td colspan="6" class="list_floor var-top">
										<table class="lists">';
								}
						?>
						<tr class="row_fst">
							<td rowspan="2" class="center label_3">
								<?php
								if(isset($floorId['floor_down']) && $floorId['floor_down'] != ""){
									if(strpos($floorId['floor_down'], '-') !== false){
										$floorDown = Yii::app()->controller->__trans("地下").' '.str_replace("-", "", $floorId['floor_down']);
									}else{
										$floorDown = $floorId['floor_down'];
									}
									if(isset($floorId['floor_up']) && $floorId['floor_up'] != ''){
										echo $floorDown.' - '.$floorId['floor_up'].' '.Yii::app()->controller->__trans('階');
									}else{
										echo $floorDown.' '.Yii::app()->controller->__trans('階');
									}
								}
								if(isset($floorId['roomname']) && $floorId['roomname'] != ""){
									echo '&nbsp;'.$floorId['roomname'];
								}
								?>
							</td>
							<td class="label_4">
								<?php
								if(isset($floorId['area_ping']) && $floorId['area_ping'] != ""){
									echo $floorId['area_ping']/*." ".Yii::app()->controller->__trans('Ping')*/;
								}else{
									echo '-';
								}
								?>
								<?php
									if(isset($floorId['payment_by_installments']) && $floorId['payment_by_installments'] == 1){
										echo '分割例 :';
									}else if(isset($floorId['payment_by_installments']) && $floorId['payment_by_installments'] == 2){
										echo '分割可 :';
									}
								?>
								<?php if(isset($floorId['floor_partition']) && $floorId['floor_partition'] != ""){
									  $expFloorParts = explode(',',$floorId['floor_partition']);
										if(!empty($expFloorParts)){
											foreach($expFloorParts as $part){
												echo $part/*.'坪'*/.',<br/>';
											}
										}
										
								}
								?>
								<?php
								if(isset($floorId['area_net']) && $floorId['area_net'] != ""){
									echo "ネット: ".$floorId['area_net']/*." 坪"*/;
								}else{
									echo '';
								}
								?>
							</td>
							<td class="label_5">
								<font><font> 
									<?php
										if($floorId['rent_unit_price_opt'] != ''){
											if($floorId['rent_unit_price_opt'] == -1){
												echo Yii::app()->controller->__trans('undecided');
											}else if($floorId['rent_unit_price_opt'] == -2){
												echo Yii::app()->controller->__trans('ask');
											}
										}else{
											echo '-';
										}
									?>
								</font></font>
								<font><font>                             
									<?php
										if(isset($floorId['rent_unit_price']) && $floorId['rent_unit_price'] != "" && $floorId['rent_unit_price'] != 0){
											echo Yii::app()->controller->renderPrice($floorId['rent_unit_price'])/*.Yii::app()->controller->__trans('yen / tsubo')*/;
										}else{
											echo '';
										}
									?>
								</font></font>
							</td>
							<td class="label_6">
								<font><font> 
								<?php
									if($floorId['unit_condo_fee'] == ""){
										if($floorId['unit_condo_fee_opt'] != ''){
											if($floorId['unit_condo_fee_opt'] == 0){
												echo Yii::app()->controller->__trans('none');
											}else if($floorId['unit_condo_fee_opt'] == -1){
												echo Yii::app()->controller->__trans('undecided');
											}else if($floorId['unit_condo_fee_opt'] == -2){
												echo Yii::app()->controller->__trans('ask');
											}else if($floorId['unit_condo_fee_opt'] == -3){
												echo '賃料に込み (含む)';
											}
										}else{
											echo '-';
										}
									}
								?>
								</font></font>
								<font><font> 
									<?php
										if(isset($floorId['unit_condo_fee']) && $floorId['unit_condo_fee'] != ""){
											echo Yii::app()->controller->renderPrice($floorId['unit_condo_fee'])/*.Yii::app()->controller->__trans('yen / tsubo')*/;
										}else{
											echo '';
										}
									?>
								</font></font>
							</td>
							<td class="label_7">
								<?php
								if(isset($floorId['rent_unit_price']) && $floorId['rent_unit_price'] != "" && $floorId['rent_unit_price'] != 0){
								?>
                                <font><font> 
									<?php
										if($floorId['deposit_opt'] != ''){
											echo '<br/>';
											if($floorId['deposit_opt'] == -1){
												echo Yii::app()->controller->__trans('undecided');
											}else if($floorId['deposit_opt'] == -3){
												echo Yii::app()->controller->__trans('none');
											}else if($floorId['deposit_opt'] == -2){
												echo Yii::app()->controller->__trans('undecided･ask');
											}
										}
										if(isset($floorId['deposit_month']) &&  $floorId['deposit_month'] != ''){
											//echo '<br/>'.$floorId['deposit_month'].' ヶ月';
										}
									?>
								</font></font><br>
								<font><font> 
									<?php
										if(isset($floorId['deposit']) && $floorId['deposit'] != ""){
											echo Yii::app()->controller->renderPrice($floorId['deposit'])/*.Yii::app()->controller->__trans('yen / tsubo')*/;
										}else{
											echo '';
										}
									?>
								</font></font>
                                <?php
								}
								?>
							</td>
							<td class="label_8 center">即入居</td>
						</tr>
						<tr class="row_second">
							<td class="label_4"><?php echo $floorId['area_m'] != "" && $floorId['area_m'] != 0 ? $floorId['area_m']/*.'m&sup2;'*/ : '-'; ?></td><!--area of space by meter-->
							<td class="label_5"><?php echo $floorId['total_rent_price'] != "" && $floorId['total_rent_price'] != 0 ? Yii::app()->controller->renderPrice($floorId['total_rent_price'])/*.'円'*/ : '-'; ?></td><!--total rent fee-->
							<td class="label_6"><?php echo $floorId['total_condo_fee'] != "" && $floorId['total_condo_fee'] != 0 ? Yii::app()->controller->renderPrice($floorId['total_condo_fee'])/*.'円'*/ : '-'; ?></td><!--total condo fee-->
							<td class="label_7"><?php echo $floorId['total_deposit'] != "" && $floorId['total_deposit'] != 0 ? Yii::app()->controller->renderPrice($floorId['total_deposit'])/*.'円'*/ : '-'; ?></td><!--total deposit-->
							<td class="label_8 center"></td><!--always blank-->
						</tr>
						<?php
							}
						?>
					</table>
				</td><!--list of the floor-->
				<?php include('_print_facility_summary.php');?>
			</tr>
			<?php
				$buildingNumber++;
				$array[] = $buildCart['map_lat'].','.$buildCart['map_long'];
				$buildNameArray[] = $buildCart['name'];
				}
			}
			?>
		</table>
	</section>
	<?php
	if(isset($requestData['print_each_building']) && $requestData['print_each_building'] == 1){
		if(isset($buildCartDetails) && count($buildCartDetails) > 0){
			foreach($buildCartDetails as $buildCart){
				$address = $buildCart['address'];
				$lat = $buildCart['map_lat'];
				$long = $buildCart['map_long'];
	?>
	<section class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
		<?php echo '<span class="build_title">'.$buildCart['name']."<span>"; ?>
		<?php /*?><iframe class="iframe" width="100%" height="700" frameborder="0" style="border:0" src="https://www.google.com/maps/embed/v1/place?key=AIzaSyDVPva_WTX0Te_Z-ri4KCgDOgpcdK8l_JI&q=<?php echo $lat.','.$long;?>" allowfullscreen></iframe><?php */?>
        <iframe width="100%" height="700" frameborder="0" style="border:0"
  src="https://www.google.com/maps/embed/v1/place?key=AIzaSyDVPva_WTX0Te_Z-ri4KCgDOgpcdK8l_JI&q=<?php echo $address; ?>" allowfullscreen> </iframe>
	</section>
	<?php
			}
		}
	}
	?>
	<?php
	if(isset($requestData['print_map']) && $requestData['print_map'] == 1){
	?>
	<div id="map" class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;"></div>
	<script src="http://maps.google.com/maps/api/js?key=AIzaSyDVPva_WTX0Te_Z-ri4KCgDOgpcdK8l_JI&v=3" type="text/javascript"></script>    
    <script src="<?php echo Yii::app()->request->baseUrl; ?>/js/markerwithlabel.js"></script>
	<style>
    .labels {
        background: #fff;
        width: auto;
        height: auto;
        padding: 5px;
        text-align: center;
        line-height: 1em;
        font-size: 14px;
        color: #000;
        border: 5px solid red;
        font-weight: bold;
    }
    </style>
	<script type="text/javascript">
        var locations = <?php echo json_encode($array); ?>;
        var buildName = <?php echo json_encode($buildNameArray); ?>
        
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 10,
            center: new google.maps.LatLng(36.6733301,135.2284552),
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });
        
        var infowindow = new google.maps.InfoWindow();
        var marker, i;
        var image = '<?php echo Yii::app()->baseUrl.'/images/icon.png';?>';			
        
        var latlngbounds = new google.maps.LatLngBounds();
        for (i = 0; i < locations.length; i++) {
            var splitLatLong = locations[i].split(',');
            var lat = splitLatLong[0];
            var long = splitLatLong[1];
            /*var marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat,long),
                map: map,
                label: { text: buildName[i] },
                labelContent: buildName[i],
                labelAnchor: new google.maps.Point(15, 65),
                labelClass: "labels", // the CSS class for the label
                labelInBackground: false,
                //label: buildName[i],
                icon: pinSymbol('red'),
                //icon: 'http://chart.apis.google.com/chart?chst='+buildName[i]+'&chld=' + k + '|FF0000|000000',
                //animation: google.maps.Animation.BOUNCE,
                //icon : image,
                visible: true
            });*/
            var marker = new MarkerWithLabel({
                position: new google.maps.LatLng(lat,long),
                map: map,
                labelContent: (i+1)+'. '+buildName[i],
                //labelAnchor: new google.maps.Point(lat,long),
                labelClass: "labels",
                //labelInBackground: false,
                //icon: image,
                icon: {},
                //animation: google.maps.Animation.BOUNCE,
                visible: true
            });
            
            /*marker.info = new google.maps.InfoWindow({
              content: buildName[i],
            });
            
            google.maps.event.addListener(marker, 'click', function() {
              marker.info.open(map, marker);
            });*/
            
            var iw = new google.maps.InfoWindow({
                content: buildName[i],
            });
            google.maps.event.addListener(marker, "click", function(e) {
                iw.open(map, this);
            });
            
            latlngbounds.extend(marker.position);
        }
        //Get the boundaries of the Map.
        var bounds = new google.maps.LatLngBounds();
        //Center map and adjust Zoom based on the position of all markers.
        map.setCenter(latlngbounds.getCenter());
        map.fitBounds(latlngbounds);
        
        marker.setMap(map);
    </script>
<?php
	}
}
?>
<?php
if($requestData['print_type'] ==8){
	if(isset($buildCartDetails) && count($buildCartDetails) > 0){
		$proposedFloors = array();
		$proposedDetails = ProposedArticle::model()->findByPk($requestData['hdnProArticleId']);
		$proposedFloors = explode(',',$proposedDetails['floor_id']);
		
		$user = Users::model()->findByAttributes(array('username'=>Yii::app()->user->getId()));
		$logged_user_id = $user->user_id;
		
		if(isset($requestData['add_cover']) && $requestData['add_cover'] == 1) {
?>
		<section class="sheet cover" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
        	<div class="client" style="font-size: 11pt; font-weight: bold; padding-left: 5mm; position: relative; padding-bottom: 2mm;">
				<?php
                    $prosalData = ProposedArticle::model()->findByPK($requestData['hdnProArticleId']);
                    $companyName = Customer::model()->findByPk($prosalData['customer_id']);
                    echo $companyName['company_name'];
                ?>
            </div><!--client company name-->
            <h1><?php echo $requestData['header_name']; ?></h1><!--title of article *editable-->
            <h4 class="subtitle">オフィスビルご紹介資料</h4><!--common sub title-->
            <h4 class="subtitle en"><?php echo Yii::app()->controller->__trans('office building information'); ?></h4><!--common sub title-->
            <div class="author" style="background: #d52b2b; padding: 5mm;">
            	<p class="company_name">株式会社 <?php echo Yii::app()->controller->__trans('Japan Properties'); ?></p><!--author company name *common-->
                <p class="address">〒106-0032 東京都港区六本木5-9-20　六本木イグノポール5階</p><!--author company address *common-->
                <p class="tel">03-5411-7500</p><!--author company tel *common-->
                <p class="email">info@properties.co.jp</p><!--author company email *common-->
                <p class="date">
					<?php  echo  date('Y.m.d'); ?>
                </p><!--author date to publish -->
            </div>
        </section>
		<?php
		}
		if(isset($requestData['print_route']) && $requestData['print_route'] == 1) {
		?>
        <section class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
        	<img src="images/route-map-sample.jpg" class="route-map"><!--image of route map-->
            <div class="notice clearfix">
            	<div class="half left">
                    <p>※契約面積・金額が㎡表示の物件は坪に換算しています。(坪換算値=3.3058)。</p>
                    <p>※賃貸条件や建物設備は変更する可能性があります。正式な内容につきましては重要事項説明書をもってご説明致します。</p>
                    <p>※ご紹介致しました物件が既に商談又は決定済みの節はご了承の程お願い申し上げます。</p>
                    <p>※賃料等課税対象となる金額には別途消費税が加算されます。</p>
                </div>
                <div class="half right">
                	<p>※共用率はワンフロア当りです。</p>
                    <p>※(案)の表示階は、分割例とします。</p>
                    <p>※★マークは想定価格を表しています。</p>
                    <p>※契約が成立した場合仲介手数料として賃料の１カ月分を申し受けます。</p>
               	</div>
            </div>
        </section>
		<?php
        }
		$buildingNumber = 1;
		foreach($buildCartDetails as $buildCart){
		?>
        <section class="sheet commercial" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
        	<table class="bd_data">
            	<tbody>
                	<tr>
                    	<td class="b_no"><span style=""><?php echo $buildCart['buildingId']; ?></span></td>
                        <td class="b_nm"><?php echo $buildingNumber.'.'.$buildCart['name']; ?></td>
                        <td class="b_address"><?php echo $buildCart['address']; ?></td>
                    </tr>
               	</tbody>
           	</table>
            
            <table class="b_info br">
            	<tbody>
                	<tr>
                    	<td class="b_build_str"><?php echo date('Y年 m月',strtotime($buildCart['built_year'])); ?></td>
                        <td class="st_data">表参道駅 9分</td>
                        <td class="b_scale_str">
							<?php
                                $typeDetails = ConstructionType::model()->findByPk($buildCart['construction_type_id']);
                                echo $typeDetails['construction_type_name'];
                            ?>
                        </td>
                        <td class="f_oa"></td>
                        <td class="f_lightline_str">
							<?php
								if($buildCart['opticle_cable'] == 0){
									echo Yii::app()->controller->__trans('unknown');
								}else if($buildCart['opticle_cable'] == 1){
									echo Yii::app()->controller->__trans('Pull Yes');
								}else if($buildCart['opticle_cable'] == 2){
									echo Yii::app()->controller->__trans('Nothing');
								}else{
									echo '-';
								}
							?>
                        </td><!--electonic cable value-->
                        <td class="f_air">
                        	<?php
								$typeDetails = ConstructionType::model()->findByPk($buildCart['construction_type_id']);
								echo $typeDetails['construction_type_name'];
							?>
                        </td><!--air condition facility value-->
                        <td class="b_usetime">24H</td><!--use of time value-->
                        <td class="b_ev_num">
							<?php
                                $elevatorExp = explode('-',$buildCart['elevator']);
                                if($elevatorExp[0] == 1){
                                    echo Yii::app()->controller->__trans('Exist');
									if($elevatorExp[1] != "" || $elevatorExp[2] != "" || $elevatorExp[3] != "" || $elevatorExp[4] != "" || $elevatorExp[5] != "") echo '(';
									
									echo isset($elevatorExp[1]) && $elevatorExp[1] != "" ? $elevatorExp[1].Yii::app()->controller->__trans('基') : "";
									echo isset($elevatorExp[2]) && $elevatorExp[2] != "" ? '/'.$elevatorExp[2].Yii::app()->controller->__trans('人乗') : "";
									echo isset($elevatorExp[3]) && $elevatorExp[3] != "" ? $elevatorExp[3].Yii::app()->controller->__trans('基・人荷用') : "";
									echo isset($elevatorExp[4]) && $elevatorExp[4] != "" ? $elevatorExp[4].Yii::app()->controller->__trans('人乗') : "";
									echo isset($elevatorExp[5]) && $elevatorExp[5] != "" ? $elevatorExp[5].'基' : "";
									if($elevatorExp[1] != "" || $elevatorExp[2] != "" || $elevatorExp[3] != "" || $elevatorExp[4] != "" || $elevatorExp[5] != "") echo ')';
                                }else if($elevatorExp[0] == -2){
                                    echo Yii::app()->controller->__trans('unknown');
                                }else if($elevatorExp[0] == 2){
                                    echo Yii::app()->controller->__trans('noexist');
                                }else{
                                    echo '-';
                                }
                            ?>
                     	</td><!--elevetor value-->
                        <td class="b_parking_num">
                        	<?php
                            	$parkingUnitNo = explode('-',$buildCart['parking_unit_no']);
								if($parkingUnitNo[0] == 1){
									echo Yii::app()->controller->__trans('exist').($parkingUnitNo[1] != "" ? '('.$parkingUnitNo[1].' '.Yii::app()->controller->__trans('台').')' : "");
								}else if($parkingUnitNo[0] == 2){
									echo Yii::app()->controller->__trans('noexist');
								}else if($parkingUnitNo[0] == 3){
									echo Yii::app()->controller->__trans('exist but unknown unit number');
								}
							?>
                        </td><!--parking value-->
                    </tr>
                </tbody>
            </table>
            
            <table class="b_data">
            	<tbody>
                <?php
                	$count2RowAbove = 0;
					$managementArray = array('1'=>'オーナー','6'=>'サブリース','7'=>'貸主代理','8'=>Yii::app()->controller->__trans('AM'),'10'=>'業者','4'=>'仲介業者','2'=>'管理会社','9'=>Yii::app()->controller->__trans('PM'),													'3'=>'ゼネコン','-1'=>'不明',);
                	$ownerDetails = OwnershipManagement::model()->findAllByAttributes(array('building_id' => (array)$buildCart['building_id']), array('order' => 'modified_on DESC', 'limit' => 10, 'group' => 'owner_company_name'));
//                 	$ownerDetails = OwnershipManagement::model()->findAll('building_id = '. $buildCart['building_id']);
//                 	echo '<pre>'; print_r($ownerDetails);die;
					foreach($ownerDetails as $owner){
						$count2RowAbove++;
				?>
                	<tr>
                    	<th class="bo_name">
                        	<span class="owner_type ">
								<?php
                                	if($owner['ownership_type'] != 0){
										echo $managementArray[$owner['ownership_type']];
									}
								?><!--業-->
                            </span><!--owner type-->
							<?php echo $owner['owner_company_name']; ?>
                        </th><!--name of owner-->
                        <th class="bo_tel1">
							<?php echo $owner['company_tel']; ?>
                        </th><!--phone no of the owner-->
                        <th class="bo_fee">
							<?php
                            if(isset($owner['charge']) && $owner['charge'] != ""){
								if (is_numeric($owner['charge'])){
									echo number_format($owner['charge'],1,'.','');
								}else{
									echo $owner['charge'];
								}
							}else{
								echo '-';
							}
							?>
                        </th><!--commision fee-->
                        <th class="bo_upd">更新
							<?php  echo date('y-m-d',strtotime($owner['modified_on'])); ?>
                        </th><!--updated date-->
                    </tr>
				<?php
                	}
				?><!--/loop of owner if owners are multiple-->
               	</tbody>
            </table>
            <p class="last_update"><!--label-->ビル情報最終更新：<!--/label-->
				<?php echo $buildCart['modified_on']; ?><!--latest updated date of building info-->
            </p><!--history of updated things-->
            <?php
			$addedOnArray = array();
			$transmissionMattersDetails = TransmissionMatters::model()->findAll('building_id = '.$buildCart['building_id']);
			$negotiationDetails = RentNegotiation::model()->findAll('building_id = '.$buildCart['building_id'].' order by rent_negotiation_id desc');
			$mergeArray = array_merge_recursive($transmissionMattersDetails,$negotiationDetails);
			foreach($mergeArray as $merge){
				$addedOnArray[] = date('Y.m.d',strtotime($merge['added_on']));
			}
			array_multisort($addedOnArray,SORT_DESC,$mergeArray);
			
// 			for ($j=0; $j<20; $j++) {
// 				$mergeArray[] = $mergeArray[0];
// 			}
			?>
			<?php
            	//$buildLogDetails = BuildingUpdateLog::model()->findAll('building_id ='.$buildCart['building_id'].' order by building_update_log_id desc limit 10');
				foreach($mergeArray as $indexLog => $log){
				if ($indexLog >= 18) {
					if ($indexLog == 18) {
						echo '</section>';
						echo '<section class="sheet commercial" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">';
					}
					continue;
				}
				$count2RowAbove ++;
			?>
            <table class="camp_info">
            	<tbody>
                	<tr>
                    	<td class="cam_date">
							<?php  echo date('y-m-d',strtotime($log['added_on'])); ?>
                        </td><!--date of updated-->
                        <td colspan="10">
							<?php
                            	//echo $log['change_content'];
								if(isset($log['note'])){
									if($log['note'] != ""){
										echo $log['note'];
									}else{
										echo '-';
									}
								}
								if(isset($log['negotiation_type'])){
									$allocateFloorDetails = Floor::model()->findAllByAttributes(array('floor_id'=>explode(',',$log['allocate_floor_id'])));
									if(isset($allocateFloorDetails) && count($allocateFloorDetails) > 0){
										$floorName = '';
										foreach($allocateFloorDetails as $floor){
											if(strpos($floor['floor_down'], '-') !== false){
												$floorDown = Yii::app()->controller->__trans("地下").' '.str_replace("-", "", $floor['floor_down']);
											}else{
												$floorDown = $floor['floor_down'];
											}
											if($floor['floor_up'] != ""){
												$floorName .= $floorDown." ~ ".$floor['floor_up'].' '.Yii::app()->controller->__trans('階');
											}else{
												$floorName .= $floorDown.' '.Yii::app()->controller->__trans('階');
											}
											/*if($merge['negotiation_type'] == 4){
												$negUnitList = '';
											}else{
												$negUnitList = '¥';
											}
											*/
											$negUnitB = '';
											$negUnit = '';
											if($log['negotiation_type'] == 1){
												$negUnit = '(共益費込み)';
												$negUnitB = ' | ¥';
											}elseif($log['negotiation_type'] == 5){
												$negUnit = '(共益費込み)';
												$negUnitB = ' | ¥';
											}elseif($log['negotiation_type'] == 2 || $log['negotiation_type'] == 3){
												$negUnit = 'ヶ月';
											}
											
											//$floorName .= " / ".$floor['area_ping'].Yii::app()->controller->__trans('tsubo').' | '.$negUnitB.Yii::app()->controller->renderPrice($log['negotiation']).' '.$negUnit;
											$floorName .= " / ".$floor['area_ping'].Yii::app()->controller->__trans('tsubo').''.$negUnitB.$negUnit;
										}									
									}else{
										$floorName = '';
									}
									
									if($log['negotiation_type'] == 1){
										echo '坪単価(底値)';
									}elseif($log['negotiation_type'] == 2){									
										echo Yii::app()->controller->__trans('Deposit negotiation value');
									}elseif($log['negotiation_type'] == 3){
										echo Yii::app()->controller->__trans('Key money negotiation value');
									}elseif($log['negotiation_type'] == 5){
										echo '坪単価(目安値)';
									}									
									else{
										echo Yii::app()->controller->__trans('Other negotiations information');
									}
									echo " ".$log['negotiation'].'<br/>'.$floorName;
								}
							?>
                       	</td><!--updated thing-->
                    </tr>
                </tbody>
            </table>
			<?php
            	}
			?><!--floor info-->
            <table class="f_info">
            	<tbody>
				<?php
				$floorDetails = Floor::model()->findAll('building_id = '.$buildCart['building_id']);
				
// 							for ($i=0; $i<20; $i++) {
// 								$floorDetails[] = $floorDetails[0];
// 							}
				
				$countFloor = 0;
				foreach($floorDetails as $floor){
					if(!in_array($floor['floor_id'],$proposedFloors)){
						continue;
					}
					$countFloor++;
					$floorId = Floor::model()->findByPk($floor['floor_id']);
					if($countFloor % 12 == 0 || ($countFloor < 12 && $count2RowAbove < 28 && $countFloor == ceil(28 - $count2RowAbove)/3)) {
						$countFloor = 12;
						echo '</tbody></table></section>';
						echo '<section class="sheet commercial" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;"><table class="f_info"><tbody>';
					}
				?><!--if multiple floors,loop-->
                	<tr style="border-bottom:1px solid #fff;">
                    	<td class="f_emp" style="width:45px;">
                        	<span style=""><?php echo $floorId['floorId']; ?></span>
                        </td><!--floor ID-->
                        <td class="f_floor_str" style="width:30px;">
							<?php
                        	if(isset($floorId['floor_down']) && $floorId['floor_down'] != ""){
								if(strpos($floorId['floor_down'], '-') !== false){
									$floorDown = Yii::app()->controller->__trans("地下").' '.str_replace("-", "", $floorId['floor_down']);
								}else{
									$floorDown = $floorId['floor_down'];
								}
								if(isset($floorId['floor_up']) && $floorId['floor_up'] != ''){
									echo $floorDown.' - '.$floorId['floor_up'].' '.Yii::app()->controller->__trans('階');
								}else{
									echo $floorDown.' '.Yii::app()->controller->__trans('階');
								}
							}
							if(isset($floorId['roomname']) && $floorId['roomname'] != ""){
								echo '&nbsp;'.$floorId['roomname'];
							}
							?>
                        </td><!--stair of the floor-->
                        <td class="f_acreg_str" style="width:42px;">
							<?php
                            	if(isset($floorId['area_ping']) && $floorId['area_ping'] != ""){
									echo $floorId['area_ping']." ".Yii::app()->controller->__trans('Ping');
								}else{
									echo '-';
								}
							?>
                        </td><!--area space of the floor-->
                        <td class="f_rentstart" style="width:50px;">
                        	<?php
							if(isset($floorId['move_in_date']) && $floorId['move_in_date'] != "" && (string)$floorId['move_in_date'] != '0'){
								echo $floorId['move_in_date'];
							}else{
								echo '-';
							}
							?>
                        </td><!--date to rent start for the floor-->
                        <td class="f_price_m_shiki" style="width:25px;">償 
							<?php
                            if(isset($floorId['total_deposit']) && $floorId['total_deposit'] != "0" && $floorId['total_deposit'] != ""){
								echo Yii::app()->controller->renderPrice($floorId['total_deposit']).' 円';
							}
							if($floorId['deposit_opt'] != ''){
								echo '<br/>';
								if($floorId['deposit_opt'] == -1){
									echo Yii::app()->controller->__trans('undecided');
								}else if($floorId['deposit_opt'] == -3){
									echo Yii::app()->controller->__trans('none');
								}else if($floorId['deposit_opt'] == -2){
									echo Yii::app()->controller->__trans('undecided･ask');
								}
							}
							if(isset($floorId['deposit_month']) &&  $floorId['deposit_month'] != ''){
								echo '<br/>'.$floorId['deposit_month'].' ヶ月';
							}
							?><br>
							<?php
                            if(isset($floorId['deposit']) && $floorId['deposit'] != "" && $floorId['deposit'] != 0){
								echo Yii::app()->controller->renderPrice($floorId['deposit']).Yii::app()->controller->__trans('yen / tsubo');
							}else{
								echo '';
							}
							?>
                        </td><!--deposit fee of the floor-->
                        <td class="f_price_t_rent" style="width:50px;">
							<?php
							if($floorId['rent_unit_price_opt'] != ''){
								if($floorId['rent_unit_price_opt'] == -1){
									echo Yii::app()->controller->__trans('undecided');
								}else if($floorId['rent_unit_price_opt'] == -2){
									echo Yii::app()->controller->__trans('ask');
								}
							}else{
								echo '-';
							}
							?>
							<?php
                            if(isset($floorId['rent_unit_price']) && $floorId['rent_unit_price'] != "" && $floorId['rent_unit_price'] != 0){
								echo Yii::app()->controller->renderPrice($floorId['rent_unit_price']).Yii::app()->controller->__trans('yen / tsubo');
							}else{
								echo '';
							}
							?>
                        </td><!--rent fee per 1 tsubo of the floor-->
                        <td class="f_price_a_rent" style="width:60px;">
							<?php echo $floorId['total_rent_price'] ? Yii::app()->controller->renderPrice($floorId['total_rent_price']).'円' : ''; ?>
                        </td><!--total rent fee of the floor-->
                        <td class="f_price_rerent" style="width:45px;">更 
							<?php
                            if(isset($floorId['renewal_fee_opt']) && $floorId['renewal_fee_opt'] != ""){
								if($floorId['renewal_fee_opt'] == 2){
									echo Yii::app()->controller->__trans('None');
								}elseif($floorId['renewal_fee_opt'] == -1){
									echo Yii::app()->controller->__trans('Unknown');
								}elseif($floorId['renewal_fee_opt'] == -2){
									echo Yii::app()->controller->__trans('Undecided･ask');
								}else{
									echo '';
								}
							}
							
							if(isset($floorId['renewal_fee_reason']) && $floorId['renewal_fee_reason'] != ""){
								if($floorId['renewal_fee_reason'] == 1){
									echo Yii::app()->controller->__trans('現賃料の');
								}elseif($floorId['renewal_fee_reason'] == 2){
									echo Yii::app()->controller->__trans('新賃料の');
								}else{
									echo '';
								}
							}
							
							if(isset($floorId['renewal_fee_recent']) && $floorId['renewal_fee_recent'] != ""){
								echo $floorId['renewal_fee_recent'].Yii::app()->controller->__trans('month');
							}
							?>
                        </td><!--renewal fee-->
                        <td class="f_price_amo_str" style="width:50px;">償 
                        	<?php
							if(isset($floorId['repayment_opt']) && $floorId['repayment_opt'] != ""){
								if($floorId['repayment_opt'] == -3){
									echo Yii::app()->controller->__trans('None');
								}elseif($floorId['repayment_opt'] == -4){
									echo Yii::app()->controller->__trans('Unknown');
								}elseif($floorId['repayment_opt'] == -1){
									echo Yii::app()->controller->__trans('Undecided');
								}elseif($floorId['repayment_opt'] == -2){
									echo Yii::app()->controller->__trans('Ask');
								}elseif($floorId['repayment_opt'] == -5){
									echo Yii::app()->controller->__trans('Sliding');
								}else{
									echo '';
								}
							}
							
							if(isset($floorId['repayment_reason']) && $floorId['repayment_reason'] != ""){
								if($floorId['repayment_reason'] == 1){
									echo Yii::app()->controller->__trans('現賃料の');
								}elseif($floorId['repayment_reason'] == 2){
									echo Yii::app()->controller->__trans('解約時賃料の');
								}else{
									echo '';
								}
							}
							
							if(isset($floorId['repayment_amt']) && $floorId['repayment_amt'] != ""){
								echo Yii::app()->controller->renderPrice($floorId['repayment_amt']);
							}
							
							if(isset($floorId['repayment_amt_opt']) && $floorId['repayment_amt_opt'] != ""){
								if($floorId['repayment_amt_opt'] == 1){
									echo Yii::app()->controller->__trans('ヶ月');
								}elseif($floorId['repayment_amt_opt'] == 2){
									echo Yii::app()->controller->__trans('%');
								}else{
									echo '';
								}
							}
							?>
                        </td><!--repayment-->
                        <td class="f_price_keymoney_str" style="width:30px;">礼 
                        	<?php
							if(isset($floorId['key_money_opt']) && $floorId['key_money_opt'] != ""){
								if($floorId['key_money_opt'] == 2){
									echo Yii::app()->controller->__trans('None');
								}elseif($floorId['key_money_opt'] == -1){
									echo Yii::app()->controller->__trans('Unknown');
								}elseif($floorId['key_money_opt'] == -2){
									echo Yii::app()->controller->__trans('undecided･ask');
								}else{
									echo '';
								}
							}else{
								echo '';
							}
							
							if(isset($floorId['key_money_month']) && $floorId['key_money_month'] != ""){
								echo $floorId['key_money_month'].Yii::app()->controller->__trans('month');
							}
							?>
                        </td><!--key money-->
                        <td class="f_oa" style="width:30px;">
                        	<?php
							if($floorId['oa_type'] == '非対応'){
								echo 'OA 非対応';
							}else if($floorId['oa_type'] == 'フリーアクセス'){
								echo 'フリーアクセス';
							}else if($floorId['oa_type'] == '1WAY'){
								echo 'OA '.Yii::app()->controller->__trans('1WAY');
							}else if($floorId['oa_type'] == '2WAY'){
								echo 'OA '.Yii::app()->controller->__trans('2WAY');
							}else if($floorId['oa_type'] == '3WAY'){
								echo 'OA '.Yii::app()->controller->__trans('3WAY');
							}else if($floorId['oa_type'] == '引き込み可'){
								echo 'OA 引き込み可';
							}else{
								echo '-';
							}
							?>
                        </td><!--OA-->
                        <td class="f_height" style="width:45px;">
                        	<?php
                            if(isset($floorId['contract_period_opt']) && $floorId['contract_period_opt'] != ""){
								if($floorId['contract_period_opt'] == 1){
									echo '通常';
								}elseif($floorId['contract_period_opt'] == 2){
									echo '定借';
								}elseif($floorId['contract_period_opt'] == 3){
									echo '定借希望';
								}else{
									echo '-';
								}
							}else{
								echo '-';
							}
							
							if(isset($floorId['contract_period_optchk']) && $floorId['contract_period_optchk'] == 1){
								echo '<br>年数相談';
							}
							
							if(isset($floorId['contract_period_duration']) && $floorId['contract_period_duration'] != ''){
								echo '<br>'.$floorId['contract_period_duration'].' 年';
							}
							?>
                  			</font></font>
                        </td><!--type of contract-->
                        <?php
						$floorTypeUseArray = array();
						$floorTypeUse = $floorId['type_of_use'];
						$floorTypeUseArray = explode(',',$floorTypeUse);
						?>
                        <td class="f_purpose1" style="width:20px;">
                        	<?php
							$opt1Val = '×事';
							if(in_array('1',$floorTypeUseArray)){
								$opt1Val = '○事';
							}
							echo $opt1Val;
							?>
                        </td><!--use for office-->
                        <td class="f_purpose2" style="width:20px;">
                            <?php
							$opt1Val = '×店';
							if(in_array('2',$floorTypeUseArray)){
								$opt1Val = '○店';
							}
							echo $opt1Val;
							?>
                        </td><!--use for shop-->
                        <td class="f_purpose4" style="width:20px;">
                            <?php
							$opt2Val = '×倉';
							if(in_array('5',$floorTypeUseArray)){
								$opt2Val = '○倉';
							}
							echo $opt2Val;
							?>
                        </td><!--use for warehouse-->
                        <td class="f_purpose8" style="width:20px;">
                            <?php
							$opt3Val = '×他';
							$otherArray = array();
							$useOfType = UseTypes::model()->findAll('is_active = 1');
							foreach($useOfType as $uType){
								if($uType['user_type_id'] == '1' || $uType['user_type_id'] == '2' || $uType['user_type_id'] == '5'){
									continue;
								}else{
									$otherArray[] = $uType['user_type_id'];
								}
							}
							$intersect = array_intersect($floorTypeUseArray,$otherArray);
							
							if(!empty($intersect)){
								$opt3Val = '○他';
							}
							echo $opt3Val;
							?>
                        </td><!--use for other-->
                    </tr>
				<?php
                	}
				?>
                </tbody>
            </table>
        </section>
		<?php
			$buildingNumber++;
        	$array[] = $buildCart['map_lat'].','.$buildCart['map_long'];
			$buildNameArray[] = $buildCart['name'];
		}
        if(isset($requestData['print_each_building']) && $requestData['print_each_building'] == 1){
			if(isset($buildCartDetails) && count($buildCartDetails) > 0){
				foreach($buildCartDetails as $buildCart){
					$address = $buildCart['address'];
					$lat = $buildCart['map_lat'];
					$long = $buildCart['map_long'];
		?>
        <section class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
			<?php echo '<span class="build_title">'.$buildCart['name']."<span>"; ?>
            <iframe width="100%" height="700" frameborder="0" style="border:0"
  src="https://www.google.com/maps/embed/v1/place?key=AIzaSyDVPva_WTX0Te_Z-ri4KCgDOgpcdK8l_JI&q=<?php echo $address; ?>" allowfullscreen> </iframe>
        </section>
		<?php
        		}
			}
		}
		if(isset($requestData['print_map']) && $requestData['print_map'] == 1) {
		?>
        <div id="map" class="sheet" style="width: 297mm; height: 1000px; page-break-after: always; position: relative;"></div>
		<script src="http://maps.google.com/maps/api/js?key=AIzaSyDVPva_WTX0Te_Z-ri4KCgDOgpcdK8l_JI&v=3" type="text/javascript"></script>
		<script src="<?php echo Yii::app()->request->baseUrl; ?>/js/markerwithlabel.js"></script>
        <style>
		.labels {
		    background: #fff;
			width: auto;
			height: auto;
			padding: 5px;
			text-align: center;
			line-height: 1em;
			font-size: 14px;
			color: #000;
			border: 5px solid red;
			font-weight: bold;
		}
		</style>
        <script type="text/javascript">
			var locations = <?php echo json_encode($array); ?>;
			var buildName = <?php echo json_encode($buildNameArray); ?>
			
			var map = new google.maps.Map(document.getElementById('map'), {
				zoom: 10,
				center: new google.maps.LatLng(36.6733301,135.2284552),
				mapTypeId: google.maps.MapTypeId.ROADMAP
			});
			
			var infowindow = new google.maps.InfoWindow();
			var marker, i;
			var image = '<?php echo Yii::app()->baseUrl.'/images/icon.png';?>';			
			
			var latlngbounds = new google.maps.LatLngBounds();
			for (i = 0; i < locations.length; i++) {
				var splitLatLong = locations[i].split(',');
				var lat = splitLatLong[0];
				var long = splitLatLong[1];
				/*var marker = new google.maps.Marker({
					position: new google.maps.LatLng(lat,long),
					map: map,
					label: { text: buildName[i] },
					labelContent: buildName[i],
					labelAnchor: new google.maps.Point(15, 65),
					labelClass: "labels", // the CSS class for the label
					labelInBackground: false,
					//label: buildName[i],
					icon: pinSymbol('red'),
					//icon: 'http://chart.apis.google.com/chart?chst='+buildName[i]+'&chld=' + k + '|FF0000|000000',
					//animation: google.maps.Animation.BOUNCE,
					//icon : image,
					visible: true
				});*/
				var marker = new MarkerWithLabel({
					position: new google.maps.LatLng(lat,long),
					map: map,
					labelContent: (i+1)+'. '+buildName[i],
					//labelAnchor: new google.maps.Point(lat,long),
					labelClass: "labels",
					//labelInBackground: false,
					//icon: image,
					icon: {},
					//animation: google.maps.Animation.BOUNCE,
					visible: true
				});
				
				/*marker.info = new google.maps.InfoWindow({
				  content: buildName[i],
				});
				
				google.maps.event.addListener(marker, 'click', function() {
				  marker.info.open(map, marker);
				});*/
				
				/*var iw = new google.maps.InfoWindow({
					content: buildName[i],
				});
				google.maps.event.addListener(marker, "click", function(e) {
					iw.open(map, this);
				});*/
				
				latlngbounds.extend(marker.position);
			}
			//Get the boundaries of the Map.
			var bounds = new google.maps.LatLngBounds();
			//Center map and adjust Zoom based on the position of all markers.
			map.setCenter(latlngbounds.getCenter());
			map.fitBounds(latlngbounds);
			
			marker.setMap(map);
		</script>
		<?php
        }
	}
}
?>
<?php
if($requestData['print_type'] == 11){
	if(isset($requestData['add_cover']) && $requestData['add_cover'] == 1) {
	?>
    	<section class="sheet cover">
            <div class="client" style="font-size: 11pt; font-weight: bold; padding-left: 5mm; position: relative; padding-bottom: 2mm;">
            <?php
                $prosalData = ProposedArticle::model()->findByPK($requestData['hdnProArticleId']);
                $companyName = Customer::model()->findByPk($prosalData['customer_id']);
                echo $companyName['company_name'];
            ?>
            </div><!--client company name-->
            <h1 style="font-size: 30px; padding-top: 50mm; margin-top: 0;"><?php echo $requestData['header_name']; ?></h1><!--title of article *editable-->
            <h4 class="subtitle" style=" margin-bottom: 1mm; margin-top: 0; ">オフィスビルご紹介資料</h4><!--common sub title-->
            <h4 class="subtitle en" style="font-family: HelveticaNeue-UltraLight; font-weight: 100;"><?php echo Yii::app()->controller->__trans('office building information'); ?></h4><!--common sub title-->
            <div class="author" style="background: #e11b30; padding: 8mm 5mm; position: absolute; bottom: 5mm; width: 267mm; margin-bottom: 2mm; line-height: 1.2;">
                <p class="company_name" style="font-size: 16pt; margin-bottom: 3mm; font-weight: bold;">株式会社 <?php echo Yii::app()->controller->__trans('Japan Properties'); ?></p><!--author company name *common-->
                <p class="address" style="margin-top: 0; font-size: 10pt; margin-bottom: 2mm;">〒106-0032 東京都港区六本木5-9-20　六本木イグノポール5階</p><!--author company address *common-->
                <p class="tel" style="margin-top: 0; font-size: 10pt; margin-bottom: 2mm;">03-5411-7500</p><!--author company tel *common-->
                <p class="email" style="margin-top: 0; font-size: 10pt; margin-bottom: 2mm;">info@properties.co.jp</p><!--author company email *common-->
                <p class="date" style="margin-top: 0; font-size: 10pt; margin-bottom: 2mm; margin-top: 5mm;">
                    <?php  echo  date('Y.m.d'); ?>
                </p><!--author date to publish -->
            </div>
        </section>
    <?php
	}
	if(isset($requestData['print_route']) && $requestData['print_route'] == 1){
	?>
    	<section class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
            <img src="images/route-map-sample.jpg" class="route-map"><!--image of route map-->
            <div class="notice clearfix">
                <div class="half left">
                    <p>※契約面積・金額が㎡表示の物件は坪に換算しています。(坪換算値=3.3058)。</p>
                    <p>※賃貸条件や建物設備は変更する可能性があります。正式な内容につきましては重要事項説明書をもってご説明致します。</p>
                    <p>※ご紹介致しました物件が既に商談又は決定済みの節はご了承の程お願い申し上げます。</p>
                    <p>※賃料等課税対象となる金額には別途消費税が加算されます。</p>
                </div>
                <div class="half right">
                    <p>※共用率はワンフロア当りです。</p>
                    <p>※(案)の表示階は、分割例とします。</p>
                    <p>※★マークは想定価格を表しています。</p>
                    <p>※契約が成立した場合仲介手数料として賃料の１カ月分を申し受けます。</p>
                </div>
            </div>
        </section>
    <?php
	}
	?>
    	<section class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
            <table class="building-profile" style="width: 277mm;">
                <caption>
                    <?php echo Yii::app()->controller->__trans('office building profile'); ?>
                </caption>
                <tr>
                    <th class="center" style="text-align: center;">No</th>
                    <th class="building-name" style="width: 110mm;">ビル名</th>
                    <th class="building-addr" style="width: 80mm;">所在地</th>
                    <th class="est-date">竣工</th>
                    <th class="floor-space">延床面積</th>
                    <th class="floor-construction">構造</th>
                </tr>
                <tr>
                <?php
                    if(isset($buildCartDetails) && count($buildCartDetails) > 0){
                        $user = Users::model()->findByAttributes(array('username'=>Yii::app()->user->getId()));
                        $logged_user_id = $user->user_id;
                        $buildingNumber = 1;
                        foreach($buildCartDetails as $buildCart){
                ?>
                    <td class="center" style="text-align: center;"><?php echo $buildingNumber; ?></td>
                    <td class="center" style="text-align: center;"><?php echo $buildCart['name']; ?></td>
                    <td class="center" style="text-align: center;"><?php echo $buildCart['address']; ?></td>
                    <td class="center" style="text-align: center;"><?php echo date('Y年 m月',strtotime($buildCart['built_year'])); ?></td>
                    <td class="center" style="text-align: center;"><?php echo $buildCart['total_floor_space'] != "" ? $buildCart['total_floor_space'].'m&sup2;' : "-"; ?></td>
                    <?php /*?><td class="center"><?php echo $buildCart['total_floor_space'] != "" ? $buildCart['total_floor_space'].'坪' : "-"; ?></td><?php */?>
                    <td class="center" style="text-align: center;">
                        <?php
                            $typeDetails = ConstructionType::model()->findByPk($buildCart['construction_type_id']);
                            echo $typeDetails['construction_type_name'];
                        ?>
                    </td>
                </tr>
                <?php
                        $array[] = $buildCart['map_lat'].','.$buildCart['map_long'];
                        $buildNameArray[] = $buildCart['name'];
                        $buildingNumber++;
                        }
                    }
                ?>
            </table>
        </section>
    <?php
	if(isset($buildCartDetails) && count($buildCartDetails) > 0){
		$user = Users::model()->findByAttributes(array('username'=>Yii::app()->user->getId()));
		$logged_user_id = $user->user_id;
		$buildingNumber = 1;
		foreach($buildCartDetails as $buildCart){
			if(isset($requestData['print_each_building']) && $requestData['print_each_building'] == 1){
				if(isset($buildCartDetails) && count($buildCartDetails) > 0){
						$address = $buildCart['address'];
						$lat = $buildCart['map_lat'];
						$long = $buildCart['map_long'];
					?>
						<section class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
							<?php echo '<span class="build_title" style="margin-top: 10px; margin-bottom: 10px; font-size: 20px;">'.$buildCart['name']."<span>"; ?>
          					<?php
							$images_path = realpath(Yii::app()->basePath . '/../pdfMaps');
							if(file_exists($images_path.'/build_'.$buildCart['building_id'].'.jpg')){
								$imageFile = $images_path.'/build_'.$buildCart['building_id'].'.jpg';
							}else{							
								$image = file_get_contents('http://maps.google.com/maps/api/staticmap?size=512x512&center='.$lat.','.$long.'&zoom=15&sensor=false&amp;key='.$gApiKey); 
								$fp  = fopen($images_path.'/build_'.$buildCart['building_id'].'.jpg', 'w+'); 
								
								fputs($fp, $image); 
								fclose($fp); 
								unset($image);
								
								$imageFile = $images_path.'/build_'.$buildCart['building_id'].'.jpg';
							}
							?>
                            <img alt="<?php echo $buildCart['name']; ?>" src="<?php echo $imageFile; ?>" style="width: 100%;">
						</section>
					<?php
				}
			}
			$floorDetails = Floor::model()->findAll('building_id = '.$buildCart['building_id'].' And vacancy_info = 1' );
// 			for ($i=0; $i<20; $i++) {
// 				$floorDetails[] = $floorDetails[0];
// 			}
// 			echo '<pre>'; print_r($floorDetails);die;
			$sum_arem = 0;
			$sum_are_net = 0;
			if(count($floorDetails) <= 9 || true){
			?>
            	<section class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
                    <table class="building-profile single-info">
                        <tr>
                            <td colspan="2" style="font-size: 30pt;"><?php echo $buildingNumber.'-'.$buildCart['name']; ?></td>
                        </tr>
                        <tr>
                        <?php
                            $buildPics = BuildingPictures::model()->find('building_id = '.$buildCart['building_id']);
                            $main_img = $buildPics['main_image'];
                            if($main_img != ""){
								$buildPics = 'front/'.$main_img;
							}else{
								$buildPics = explode(',',$buildPics['front_images']);
								$buildPics = 'front/'.$buildPics[0];
							}
							
							if($buildPics == "front/"){
								$buildPics = 'noimg_building.png';
							}
                        ?>
                            <td style="width: 25%; vertical-align: top;">
                                <img src="<?php echo Yii::app()->baseUrl.'/buildingPictures/'.$buildPics; ?>" style="width:100%;"/>
                            </td>
                            <td style="width: 75%; padding: 0 0 0 10mm; vertical-align: top;">
                                <table style="width: 100%; font-size:28pt !important;">
                                        <caption style="font-size:24pt;">
                                            募集状況
                                        </caption>
                                        <tr>
                                            <th>階数</th>
                                            <th colspan="2">面積(<?php echo Yii::app()->controller->__trans('NET'); ?>)</th>
                                            <th>預託金</th>
                                            <th>賃料</th>
                                            <th>共益費</th>
                                            <th>入居予定日/備考</th>
                                        </tr>
                                        <?php
                                        foreach($floorDetails as $indexFloor => $floor){
                                            $floorId = Floor::model()->findByPk($floor['floor_id']);
                                            if($indexFloor && ($indexFloor % 20 == 0 || ($indexFloor > 20 && $indexFloor % 20 == 11))) {
                                            	echo '</table></td></tr></table></section>
													<section class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
													<table class="building-profile single-info">
													<tr>
							                            <td colspan="2" class="title" style="font-size: 30pt;"></td>
							                        </tr>
													<tr>
														<td class="td_col1_3">
							                            </td>
							                            <td class="td_col2_3">
							                                <table class="current_status" style="margin-top: 10px">
																<caption>
						                                            募集状況
						                                        </caption>
						                                        <tr>
						                                            <th>階数</th>
						                                            <th colspan="2">面積('. Yii::app()->controller->__trans("NET").')</th>
						                                            <th>預託金</th>
						                                            <th>賃料</th>
						                                            <th>共益費</th>
						                                            <th>入居予定日/備考</th>
						                                        </tr>';
                                            }
                                        ?>
                                        <tr>
                                            <td class="stairs center" style="text-align: center;">
                                                <?php
                                                if(isset($floorId['floor_down']) && $floorId['floor_down'] != ""){
                                                    if(strpos($floorId['floor_down'], '-') !== false){
                                                        $floorDown = Yii::app()->controller->__trans("地下").' '.str_replace("-", "", $floorId['floor_down']);
                                                    }else{
                                                        $floorDown = $floorId['floor_down'];
                                                    }
                                                    if(isset($floorId['floor_up']) && $floorId['floor_up'] != ''){
                                                        echo $floorDown.' - '.$floorId['floor_up'].' '.Yii::app()->controller->__trans('階');
                                                    }else{
                                                        echo $floorDown.' '.Yii::app()->controller->__trans('階');
                                                    }
                                                }
												if(isset($floorId['roomname']) && $floorId['roomname'] != ""){
													echo '&nbsp;'.$floorId['roomname'];
												}
                                                ?>
                                            </td>
                                            <td class="space center" style="text-align: center;">
                                                <font>
                                                    <font>
                                                        <?php
                                                        if(isset($floorId['area_ping']) && $floorId['area_ping'] != ""){
                                                            echo $floorId['area_ping']." ".Yii::app()->controller->__trans('Ping');
                                                        }else{
                                                            echo '-';
                                                        }echo "<br/>";
                                                        ?>
                                                        <?php
                                                            if(isset($floorId['payment_by_installments']) && $floorId['payment_by_installments'] == 1){
                                                                echo '分割例 :';
                                                            }else if(isset($floorId['payment_by_installments']) && $floorDetails['payment_by_installments'] == 2){
                                                                echo '分割可 :';
                                                            }
                                                        ?>
                                                        <?php if(isset($floorId['floor_partition']) && $floorId['floor_partition'] != ""){
                                                              $expFloorParts = explode(',',$floorId['floor_partition']);
                                                                if(!empty($expFloorParts)){
                                                                    foreach($expFloorParts as $part){
                                                                        echo $part.'坪,'.'<br/>';
                                                                    }
                                                                }
                                                                
                                                        }
                                                        ?>
                                                    </font>
                                                </font>
                                          </td>
                                          <td class="space center" style="text-align: center;">
                                                <font>
                                                    <font>
                                                    <?php
                                                    if(isset($floorId['area_m']) && $floorId['area_m'] != ""){
                                                        echo $floorId['area_m']." ".Yii::app()->controller->__trans('m&sup2;');
                                                    }else{
                                                        echo '-';
                                                    }
                                                    ?>
            
                                                    </font>
                                                </font>
                                                
                                                <font>
                                                    <font>
                                                    <?php
                                                    if(isset($floorId['area_net']) && $floorId['area_net'] != ""){
                                                        echo "ネット: ".$floorId['area_net']." 坪";
                                                    }else{
                                                        echo '';
                                                    }
                                                    ?>
                                                    </font>
                                                </font>	
                                            </td>
                                            <td class="deposit right-align" style="text-align: right;">
                                                <font><font> 
                                                    <?php
                                                        if(isset($floorId['deposit']) && $floorId['deposit'] != "" && $floorId['deposit'] != 0){
															echo Yii::app()->controller->renderPrice($floorId['deposit']).Yii::app()->controller->__trans('yen / tsubo');
                                                        }else{
                                                            echo '';
                                                        }
														if($floorId['deposit_opt'] != ''){
															if($floorId['deposit_opt'] == -1){
																echo Yii::app()->controller->__trans('undecided');
															}else if($floorId['deposit_opt'] == -3){
																echo Yii::app()->controller->__trans('none');
															}else if($floorId['deposit_opt'] == -2){
																echo Yii::app()->controller->__trans('undecided･ask');
															}
														}
														
														/*if(isset($floorId['deposit_month']) &&  $floorId['deposit_month'] != ''){
															echo '<br/>'.$floorId['deposit_month'].' ヶ月';
														}*/
                                                    ?>
                                                </font></font>
                                            </td>
                                            <td class="rent-fee right-align" style="text-align: right;">
                                                <font><font> 
                                                
                                                    <?php
                                                        if(isset($floorId['rent_unit_price']) && $floorId['rent_unit_price'] != "" && $floorId['rent_unit_price'] != 0){
                                                            echo Yii::app()->controller->renderPrice($floorId['rent_unit_price']).Yii::app()->controller->__trans('yen / tsubo');
                                                        }else{
                                                            echo '';
                                                        }
														if($floorId['rent_unit_price_opt'] != ''){
															if($floorId['rent_unit_price_opt'] == -1){
																echo Yii::app()->controller->__trans('undecided');
															}else if($floorId['rent_unit_price_opt'] == -2){
																echo Yii::app()->controller->__trans('ask');
															}
														}else{
															echo '';
														}
                                                    ?>
                                                </font></font>
                                            </td>
                                            <td class="condo-fee right-align" style="text-align: right;">
                                                <font><font> 
                                                    <?php
                                                        if(isset($floorId['unit_condo_fee']) && $floorId['unit_condo_fee'] != ""){
                                                            echo Yii::app()->controller->renderPrice($floorId['unit_condo_fee']).Yii::app()->controller->__trans('yen / tsubo');
                                                        }else{
                                                            echo '';
                                                        }
														
														if($floorId['unit_condo_fee_opt'] != ''){
															if($floorId['unit_condo_fee_opt'] == 0){
																echo Yii::app()->controller->__trans('none');
															}else if($floorId['unit_condo_fee_opt'] == -1){
																echo Yii::app()->controller->__trans('undecided');
															}else if($floorId['unit_condo_fee_opt'] == -2){
																echo Yii::app()->controller->__trans('ask');
															}else if($floorId['unit_condo_fee_opt'] == -3){
																echo '賃料に込み (含む)';
															}
														}else{
															echo '-';
														}
                                                    ?>
                                                </font></font>
                                            </td>
                                            <td class="date-move center" style="text-align: center;">
                                                <?php
                                                    if(isset($floorId['move_in_date']) && $floorId['move_in_date'] != "" && (string)$floorId['move_in_date'] != '0'){
                                                        echo $floorId['move_in_date'];
                                                    }else{
                                                        echo '-';
                                                    }
                                                ?>
                                            </td>
                                            <?php $sum_arem += $floorId['area_ping']; ?>
                                            <?php $sum_are_net += $floorId['area_m']; ?>
                                        </tr>
                                        <tr>
                                            <td class="stairs center" style="text-align: center;"></td>
                                            <td class="space center" style="text-align: center;"></td>
                                            <td class="space center" style="text-align: center;"></td>
                                            <td class="deposit right-align" style="text-align: right;">
                                                <font><font> 
                                                    <?php
                                                        if(isset($floorId['total_deposit']) && $floorId['total_deposit'] != "0" && $floorId['total_deposit'] != ""){
                                                            echo Yii::app()->controller->renderPrice($floorId['total_deposit']).' 円';
                                                        }else{
															echo '';
														}
                                                    ?>
                                                </font></font>
                                            </td>
                                            <td class="rent-fee right-align" style="text-align: right;">
                                                <font><font> 
                                                    <?php
                                                        if(isset($floorId['total_rent_price']) && $floorId['total_rent_price'] != ""){
                                                            echo Yii::app()->controller->renderPrice($floorId['total_rent_price']).'円';
                                                        }else{
                                                            echo '-';
                                                        }
                                                    ?>
                                                </font></font>
                                            </td>
                                            <td class="condo-fee right-align" style="text-align: right;">
                                            	<font><font> 
                                                    <?php
                                                        if(isset($floorId['total_condo_fee']) && $floorId['total_condo_fee'] != ""){
                                                            echo Yii::app()->controller->renderPrice($floorId['total_condo_fee']).Yii::app()->controller->__trans('yen');
                                                        }else{
                                                            
                                                        }
                                                    ?>
                                                </font></font>
                                            </td>
                                            <td class="date-move center"></td>
                                        </tr>
                                        <?php
                                        }
                                        ?><!--blank cell *if there are 3 floors that you choose-->
                                        <?php for($i=0; $i< 15 - (count($floorDetails) * 2) - 1; $i++) {?>
                                        <tr>
                                            <td class="stairs center" style="text-align: center;"></td>
                                            <td class="space center" style="text-align: center;"></td>
                                            <td class="space center" style="text-align: center;"></td>
                                            <td class="deposit right-align" style="text-align: right;"></td>
                                            <td class="rent-fee right-align" style="text-align: right;"></td>
                                            <td class="condo-fee right-align" style="text-align: right;"></td>
                                            <td class="date-move center" style="text-align: center;"></td>
                                        </tr>
                                        <?php }?>
                                        <tr>
                                            <td class="total" style="padding-left: 3mm;">計</td>
                                            <td class="space center" style="text-align: center;"><?php echo $sum_arem; ?>坪</td>
                                            <td class="space center" style="text-align: center;"><?php echo $sum_are_net; ?><?php echo Yii::app()->controller->__trans('m'); ?>&sup2;</td>
                                            <td class="deposit right-align" style="text-align: right;"></td>
                                            <td class="rent-fee right-align" style="text-align: right;"></td>
                                            <td class="condo-fee right-align" style="text-align: right;"></td>
                                            <td class="date-move center" style="text-align: center;"></td>
                                        </tr>
                                        <tr>
                                            <td class="right-align notes" colspan="7" style="text-align: right; line-height: 1.4;">上段：坪単価 下段：総額<br/>
                                            賃料等課税対象となる金額には別途消費税が加算されます</td>
                                        </tr>
                                    </table>
                            </td>
                        </tr>
                        
                        <?php 
                        if (count($floorDetails) > 13 && count($floorDetails) <= 19) {
                        	echo '</table></section>
									<section class="sheet" style="width: 297mm; height: 189mm; page-break-after: always; position: relative;">
									<table class="building-profile single-info">
									';
                        }?>
                        <tr>
                            <td class="space-empty"></td>
                            <td rowspan="2" class="var-top td_col2_3 details">
                                <table class="building-details">
                                    <tr>
                                        <td class="var-top">
                                            <table class="summary building-summary">
                                                <caption>ビル概要</caption>
                                                <tr>
                                                    <th>所在地</th>
                                                    <td><?php echo $buildCart['address']; ?></td>
                                                </tr>
                                                <tr>
                                                    <th>交通</th>
                                                    <td>
                                                        <?php
                                                            $trafficDetails = BuildingStation::model()->find('building_id = '.$buildCart['building_id'].' order by time');
                                                            echo $trafficDetails['name'].' 駅'.$trafficDetails['line'].' 徒歩'.$trafficDetails['time'].'分';
                                                        ?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>竣工年月</th>
                                                    <td><?php echo date('Y年 m月',strtotime($buildCart['added_on'])); ?></td>
                                                </tr>
                                                <tr>
                                                    <th>規模</th>
                                                    <td>
														<?php
                                                        	if(isset($buildCart['floor_scale']) && $buildCart['floor_scale'] != ""){
																$scaleExp = explode('-',$buildCart['floor_scale']);
																$floorGround = $scaleExp[0];
																$floorUnderGround = $scaleExp[1];
																if($floorGround != "" && $floorUnderGround != ""){
																	echo $floorGround.'F/B'.$floorUnderGround;
																}else{
																	if($floorGround != ""){
																		echo $floorGround.'F';	
																	}elseif($floorUnderGround != ""){
																		echo 'B'.$floorUnderGround;
																	}else{
																		echo '';
																	}
																}
															}else{
																echo '-';
															}
														?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>ﾘﾆｭｰｱﾙ</th>
                                                    <td><?php echo $buildCart['renewal_data'] != "" ? $buildCart['renewal_data'] : "-"; ?></td>
                                                </tr>
                                                <tr>
                                                    <th>構造</th>
                                                    <td>
                                                        <?php
                                                            $typeDetails = ConstructionType::model()->findByPk($buildCart['construction_type_id']);
                                                            echo $typeDetails['construction_type_name'];
                                                        ?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>延床面積</th>
                                                    <td><?php echo $buildCart['total_floor_space'] != "" ? $buildCart['total_floor_space'].' m&sup2;' : "-"; ?></td>
                                                </tr>
                                                <tr>
                                                    <th>基準階面積</th>
                                                    <td><?php echo $buildCart['std_floor_space'] != "" ? $buildCart['std_floor_space'].' 坪' : "-"; ?></td>
                                                </tr>
                                                <tr>
                                                    <th>共用率</th>
                                                    <td><?php echo $buildCart['shared_rate'] != "" ? $buildCart['shared_rate'].'%' : "-"; ?></td>
                                                </tr>
                                            </table>
                                            
                                            <table class="summary facility-summary">
                                                <caption>設備概要</caption>
                                                <tr>
                                                    <th>空調制御</th>
                                                    <td>
                                                        <?php
                                                            if($buildCart['air_control_type'] == 0){
                                                                echo Yii::app()->controller->__trans('unknown');
                                                            }else if($buildCart['air_control_type'] == 2){
                                                                echo Yii::app()->controller->__trans('Individual control');
                                                            }else if($buildCart['air_control_type'] == 1){
                                                                echo Yii::app()->controller->__trans('Zone control');
                                                            }
                                                        ?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>天井高</th>
                                                    <td><?php echo '基準階：'.($buildCart['ceiling_height'] != "" ? $buildCart['ceiling_height'].'mm' : "-"); ?></td>
                                                </tr>
                                                <tr>
                                                    <th>OAフロア</th>
                                                    <td>
                                                        <?php
                                                            $floorOAList = Floor::model()->findAll('building_id = '.$buildCart['building_id'].' AND vacancy_info = 1');
                                                            $oaDefaultArray = array('フリーアクセス','3WAY','2WAY','1WAY','引き込み可','非対応');
                                                            foreach($floorOAList as $floorOA){
                                                                $oaFloor[] = $floorOA['oa_type'];
                                                            }
                                                            foreach($oaDefaultArray as $oa){
                                                                if(in_array($oa,$oaFloor)){
                                                                    echo $oa;
                                                                    break;
                                                                }
                                                            }
                                                            /*if(isset( $buildCart['oa_floor']) &&  $buildCart['oa_floor'] != ''){
                                                                $oaExplode = explode('-',$buildCart['oa_floor']);
                                                                if($oaExplode[0] == 0){
                                                                    echo Yii::app()->controller->__trans('unknown');
                                                                }else if($oaExplode[0] == 2){
                                                                    echo $oaExplode[1] != "" ? $oaExplode[1].'mm' : "-";
                                                                }else if($oaExplode[0] == 1){
                                                                    echo Yii::app()->controller->__trans('Nothing');
                                                                }else {
                                                                    echo '-';
                                                                }
                                                            }*/
                                                        ?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>セキュリティ</th>
                                                    <td>
                                                        <?php
                                                            $securityDetails = Security::model()->findByPk($buildCart['security_id']);
                                                            echo $securityDetails['security_name'];
                                                        ?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>光ケーブル</th>
                                                    <td>
                                                        <?php
                                                            if($buildCart['opticle_cable'] == 0){
                                                                echo Yii::app()->controller->__trans('unknown');
                                                            }else if($buildCart['opticle_cable'] == 1){
                                                                echo Yii::app()->controller->__trans('Pull Yes');
                                                            }else if($buildCart['opticle_cable'] == 2){
                                                                echo Yii::app()->controller->__trans('Nothing');
                                                            }else{
                                                                echo '-';
                                                            }
                                                        ?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>エレベーター</th>
                                                    <td>
                                                        <?php
                                                            if(isset($buildCart['elevator']) && $buildCart['elevator'] != ''){
                                                                if(strlen($buildCart['elevator']) > 2){
                                                                    $elevatorExp = explode('-',$buildCart['elevator']);
                                                                    if($elevatorExp[0] == 1){
                                                                        echo Yii::app()->controller->__trans('Exist');
																		if($elevatorExp[1] != "" || $elevatorExp[2] != "" || $elevatorExp[3] != "" || $elevatorExp[4] != "" || $elevatorExp[5] != "") echo '(';
																		
																		echo isset($elevatorExp[1]) && $elevatorExp[1] != "" ? $elevatorExp[1].Yii::app()->controller->__trans('基') : "";
																		echo isset($elevatorExp[2]) && $elevatorExp[2] != "" ? '/'.$elevatorExp[2].Yii::app()->controller->__trans('人乗') : "";
																		echo isset($elevatorExp[3]) && $elevatorExp[3] != "" ? $elevatorExp[3].Yii::app()->controller->__trans('基・人荷用') : "";
																		echo isset($elevatorExp[4]) && $elevatorExp[4] != "" ? $elevatorExp[4].Yii::app()->controller->__trans('人乗') : "";
																		echo isset($elevatorExp[5]) && $elevatorExp[5] != "" ? $elevatorExp[5].'基' : "";
																		if($elevatorExp[1] != "" || $elevatorExp[2] != "" || $elevatorExp[3] != "" || $elevatorExp[4] != "" || $elevatorExp[5] != "") echo ')';
                                                                    }else{
                                                                        echo '-';
                                                                    }
                                                                }else{
                                                                    if($buildCart['elevator'] == -2){
                                                                        echo Yii::app()->controller->__trans('unknown');
                                                                    }else if($buildCart['elevator'] == 2){
                                                                        echo Yii::app()->controller->__trans('noexist');
                                                                    }
                                                                }
                                                            }else{
                                                                echo '-';
                                                            }
                                                        ?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <th>駐車場</th>
                                                    <td>
                                                        <?php
                                                            if(isset($buildCart['parking_unit_no']) && count($buildCart['parking_unit_no']) > 0){
                                                                $parkingUnitNo = explode('-',$buildCart['parking_unit_no']);
                                                                if($parkingUnitNo[0] == 1){
                                                                   echo Yii::app()->controller->__trans('exist').($parkingUnitNo[1] != "" ? '('.$parkingUnitNo[1].' '.Yii::app()->controller->__trans('台').')' : "");
                                                                }else if($parkingUnitNo[0] == 2){
                                                                    echo Yii::app()->controller->__trans('noexist');
                                                                }else if($parkingUnitNo[0] == 3){
                                                                    echo Yii::app()->controller->__trans('exist but unknown unit number');
                                                                }
                                                            }
                                                        ?>
                                                    </td>
                                                </tr>
                                            </table>
                                        </td>
                                        <td class="pad-left var-top">
                                            <table class="summary contract-info">
                                            <?php
                                                $contractArray = $renewalArray = $renewalFeeMonthArray = $keymoneyArray = $keyMoneyMonthArray = $amortizationArray = $repaymentMonthArray = array();
												$fName = $renewalDetails = $renewalOpt = $keyMoneyDetails =  $keyMoneyOpt = $amortizationDetails = $repaymentOpt = '';
												foreach($floorDetails as $floor){
													if($floorId['renewal_fee_opt'] != 0){
														$renewalArray[$floor['floor_id']] = $floorId['renewal_fee_opt'];
													}
													$renewalFeeMonthArray[$floor['floor_id']] = $floorId['renewal_fee_recent'];
													if($floorId['key_money_opt'] != 0){
														$keymoneyArray[$floor['floor_id']] = $floorId['key_money_opt'];
													}
													$keyMoneyMonthArray[$floor['floor_id']] = $floorId['key_money_month'];
													if($floorId['repayment_opt'] != 0){
														$amortizationArray[$floor['floor_id']] = $floorId['repayment_opt'];
													}
													$repaymentMonthArray[$floor['floor_id']] = $floorId['repayment_amt'];
												}
												$renewalArray = array_unique($renewalArray);


												$keymoneyArray = array_unique($keymoneyArray);
												$amortizationArray = array_unique($amortizationArray);
												
												$renewalFeeMonthArray = array_unique($renewalFeeMonthArray);
												$keyMoneyMonthArray = array_unique($keyMoneyMonthArray);
												$repaymentMonthArray = array_unique($repaymentMonthArray);
												
												$k = 0;
												if(count($renewalArray) > 0){
													foreach($renewalArray as $key=>$val){
														if($k == count($renewalArray)-1){
															$slsh = '';
														}else{
															$slsh = '/';
														}
														$floorId = Floor::model()->findByPk($key);
														if(isset($floorId['floor_down']) && $floorId['floor_down'] != ""){
															if(strpos($floorId['floor_down'], '-') !== false){
																$floorDown = Yii::app()->controller->__trans("地下").' '.str_replace("-", "", $floorId['floor_down']);
															}else{
																$floorDown = $floorId['floor_down'];
															}									
															if(isset($floorId['floor_up']) && $floorId['floor_up'] != ''){
																$fName =  $floorDown.' - '.$floorId['floor_up'].' '.Yii::app()->controller->__trans('階');
															}else{
																$fName =  $floorDown.' '.Yii::app()->controller->__trans('階');
															}
														}
														
														if(isset($floorId['roomname']) && $floorId['roomname'] != ""){
															$fName .= '&nbsp;'.$floorId['roomname'];
														}
														if($val != 0 && $val != ""){
															if($val == 2){
																$renewalOpt = Yii::app()->controller->__trans('None');
															}else if($val == -1){
																$renewalOpt = Yii::app()->controller->__trans('unknown');
															}else if($val == -2){
																$renewalOpt = Yii::app()->controller->__trans('Undecided');
															}
															$renewalDetails .= $renewalOpt.(count($renewalArray) > 2 ? '('.$fName.')'.$slsh : '');
														}
														$k++;
													}
												}else{
													foreach($renewalFeeMonthArray as $key=>$val){
														if($k == count($renewalFeeMonthArray)-1){
															$slsh = '';
														}else{
															$slsh = '/';
														}
														$floorId = Floor::model()->findByPk($key);
														if(isset($floorId['floor_down']) && $floorId['floor_down'] != ""){
															if(strpos($floorId['floor_down'], '-') !== false){
																$floorDown = Yii::app()->controller->__trans("地下").' '.str_replace("-", "", $floorId['floor_down']);
															}else{
																$floorDown = $floorId['floor_down'];
															}									
															if(isset($floorId['floor_up']) && $floorId['floor_up'] != ''){
																$fName =  $floorDown.' - '.$floorId['floor_up'].' '.Yii::app()->controller->__trans('階');
															}else{
																$fName =  $floorDown.' '.Yii::app()->controller->__trans('階');
															}
														}
														
														if(isset($floorId['roomname']) && $floorId['roomname'] != ""){
															$fName .= '&nbsp;'.$floorId['roomname'];
														}
														
														$renewalDetails .= $val.'ヶ月'.(count($renewalFeeMonthArray) > 2 ? '('.$fName.')'.$slsh : '');
														$k++;
													}
												}
												
												$j = 0;
												if(count($keymoneyArray) > 0){
													foreach($keymoneyArray as $key=>$val){
														if($j == count($keymoneyArray)-1){
															$slsh = '';
														}else{
															$slsh = '/';
														}
														$floorId = Floor::model()->findByPk($key);
														if(isset($floorId['floor_down']) && $floorId['floor_down'] != ""){
															if(strpos($floorId['floor_down'], '-') !== false){
																$floorDown = Yii::app()->controller->__trans("地下").' '.str_replace("-", "", $floorId['floor_down']);
															}else{
																$floorDown = $floorId['floor_down'];
															}									
															if(isset($floorId['floor_up']) && $floorId['floor_up'] != ''){
																$fName =  $floorDown.' - '.$floorId['floor_up'].' '.Yii::app()->controller->__trans('階');
															}else{
																$fName =  $floorDown.' '.Yii::app()->controller->__trans('階');
															}
														}
														
														if(isset($floorId['roomname']) && $floorId['roomname'] != ""){
															$fName .= '&nbsp;'.$floorId['roomname'];
														}
														if($val != 0 && $val != ""){
															if($val == 2){
																$keyMoneyOpt = Yii::app()->controller->__trans('None');
															}else if($val == -1){
																$keyMoneyOpt = Yii::app()->controller->__trans('unknown');
															}else if($val == -2){
																$keyMoneyOpt = Yii::app()->controller->__trans('Undecided');
															}
															$keyMoneyDetails .= $keyMoneyOpt.(count($keymoneyArray) > 2 ? '('.$fName.')'.$slsh : '');
														}
														$j++;
													}
												}else{
													foreach($keyMoneyMonthArray as $key=>$val){
														if($j == count($keyMoneyMonthArray)-1){
															$slsh = '';
														}else{
															$slsh = '/';
														}
														$floorId = Floor::model()->findByPk($key);
														if(isset($floorId['floor_down']) && $floorId['floor_down'] != ""){
															if(strpos($floorId['floor_down'], '-') !== false){
																$floorDown = Yii::app()->controller->__trans("地下").' '.str_replace("-", "", $floorId['floor_down']);
															}else{
																$floorDown = $floorId['floor_down'];
															}									
															if(isset($floorId['floor_up']) && $floorId['floor_up'] != ''){
																$fName =  $floorDown.' - '.$floorId['floor_up'].' '.Yii::app()->controller->__trans('階');
															}else{
																$fName =  $floorDown.' '.Yii::app()->controller->__trans('階');
															}
														}
														
														if(isset($floorId['roomname']) && $floorId['roomname'] != ""){
															$fName .= '&nbsp;'.$floorId['roomname'];
														}
														$keyMoneyDetails .= $val.'ヶ月'.(count($keyMoneyMonthArray) > 2 ? '('.$fName.')'.$slsh : '');
														$j++;
													}
												}
												
												$z = 0;
												if(count($amortizationArray) > 0){
													foreach($amortizationArray as $key=>$val){
														if($z == count($amortizationArray)-1){
															$slsh = '';
														}else{
															$slsh = '/';
														}
														$floorId = Floor::model()->findByPk($key);
														if(isset($floorId['floor_down']) && $floorId['floor_down'] != ""){
															if(strpos($floorId['floor_down'], '-') !== false){
																$floorDown = Yii::app()->controller->__trans("地下").' '.str_replace("-", "", $floorId['floor_down']);
															}else{
																$floorDown = $floorId['floor_down'];
															}									
															if(isset($floorId['floor_up']) && $floorId['floor_up'] != ''){
																$fName =  $floorDown.' - '.$floorId['floor_up'].' '.Yii::app()->controller->__trans('階');
															}else{
																$fName =  $floorDown.' '.Yii::app()->controller->__trans('階');
															}
														}
														
														if(isset($floorId['roomname']) && $floorId['roomname'] != ""){
															$fName .= '&nbsp;'.$floorId['roomname'];
														}
														if($val != 0 && $val != ""){
															if($val == -3){
																$repaymentOpt = Yii::app()->controller->__trans('None');
															}else if($val == -4){
																$repaymentOpt = Yii::app()->controller->__trans('unknown');
															}else if($val == -1){
																$repaymentOpt = Yii::app()->controller->__trans('Undecided');
															}else if($val == -2){
																$repaymentOpt = Yii::app()->controller->__trans('Consultation');
															}else if($val == -5){
																$repaymentOpt = Yii::app()->controller->__trans('Sliding');
															}
															$amortizationDetails .= $repaymentOpt.(count($amortizationArray) > 2 ? '('.$fName.')'.$slsh : '');
														}
														$z++;
													}
												}else{
													foreach($repaymentMonthArray as $key=>$val){
														if($z == count($repaymentMonthArray)-1){
															$slsh = '';
														}else{
															$slsh = '/';
														}
														$floorId = Floor::model()->findByPk($key);
														if(isset($floorId['floor_down']) && $floorId['floor_down'] != ""){
															if(strpos($floorId['floor_down'], '-') !== false){
																$floorDown = Yii::app()->controller->__trans("地下").' '.str_replace("-", "", $floorId['floor_down']);
															}else{
																$floorDown = $floorId['floor_down'];
															}									
															if(isset($floorId['floor_up']) && $floorId['floor_up'] != ''){
																$fName =  $floorDown.' - '.$floorId['floor_up'].' '.Yii::app()->controller->__trans('階');
															}else{
																$fName =  $floorDown.' '.Yii::app()->controller->__trans('階');
															}
														}
														
														if(isset($floorId['roomname']) && $floorId['roomname'] != ""){
															$fName .= '&nbsp;'.$floorId['roomname'];
														}
														$amortizationDetails .= ($val != "" ? $val.'ヶ月' : "").(count($repaymentMonthArray) > 2 ? '('.$fName.')'.$slsh : '');
														$z++;
													}
												}
												$contractOptArray = array();
                                                foreach($floorDetails as $floor){
                                                    $floorId = Floor::model()->findByPk($floor['floor_id']);
                                                    if(isset( $floorId['contract_period_duration']) &&  $floorId['contract_period_duration'] != ''){
                                                        $contractArray[] = $floorId['contract_period_duration'];
														$contractOptArray[] =  $floorId['contract_period_opt'];
                                                    }
                                                }
												
												
                                                $contractdiff= array_diff_assoc($contractArray, array_unique($contractArray));
                                            ?>
                                                <caption><font><font><?php echo Yii::app()->controller->__trans('Contractual coverage'); ?></font></font></caption>
                                                <tbody>
                                                    <tr>
                                                        <th><font><font><?php echo Yii::app()->controller->__trans('Contractual life'); ?></font></font></th><!--fixed texts-->
                                                        <td>
                                                            <font><font>
                                                            <?php
                                                            if(count($contractdiff) > 0){
                                                                echo min($contractArray).(min($contractArray) != max($contractArray) ? ' ~ '.max($contractArray).' 年' : ' 年');
                                                            }else{
                                                                $contactVar = array_values($contractArray);
                                                                if($contactVar[0] != ""){
                                                                    echo $contactVar[0].' 年';
                                                                }else{
                                                                    echo '-';
                                                                }
                                                            }
                                                            ?>
                                                            </font></font>
                                                            <?php
																$contractDefaultArray = array('1'=>'普通借家','2'=>'定借','3'=>'定借希望');
																foreach($contractDefaultArray as $key=>$val){
																	if(in_array($key,$contractOptArray)){
																		echo ' - '.$val;
																		break;
																	}
																}
															?>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th>
                                                            <font><font>更新費</font></font>
                                                        </th>
                                                        <td>
                                                        	<?php
                                                            	echo $renewalDetails;
															?>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th>
                                                            <font><font>礼金</font></font>
                                                        </th>
                                                        <td>
															<?php
                                                            	echo $keyMoneyDetails;
															?>
                                                        </td>
                                                    </tr>
                                                    <tr>
                                                        <th>
                                                            <font><font>償却費</font></font>
                                                        </th>
                                                        <td>
                                                        	<?php
                                                            	echo $amortizationDetails;
															?>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                            <table class="summary time-to-use">
                                                <?php
                                                if(isset($requestData['print_time_floor']) || isset($requestData['print_time_entrance'])){
                                                ?>
                                                <caption>使用時間</caption>
                                                <?php
                                                }
                                                if(isset($requestData['print_time_floor']) == 1){
                                                    $limit_of_usage_time =  array();
                                                    if(isset($buildCart['limit_of_usage_time']) && $buildCart['limit_of_usage_time'] != ''){
                                                ?>
                                                <tr>
                                                    <th rowspan="3">使用時間</th>
                                                    <td>
                                                        <?php
                                                            $limit_of_usage_time = explode(',',$buildCart['limit_of_usage_time']);
                                                            $limitTimeExplode = explode('-',$limit_of_usage_time[0]);
                                                            if($limitTimeExplode[0] == 1){

                                                                echo '平日 : '.Yii::app()->controller->__trans('Nothing');
                                                            }else if($limitTimeExplode[0] == 2){
                                                                echo '平日： 制限有り('.$limitTimeExplode[1].')';
                                                            }else if($limitTimeExplode[0] == 3){
                                                                echo ' 平日 : '.Yii::app()->controller->__trans('unknown');
                                                            }else{
                                                                echo '-';
                                                            }
                                                        ?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <?php
                                                            if(isset($limit_of_usage_time[1]) && count($limit_of_usage_time[1]) > 0){
                                                                $limitTimeExplode2 = explode('-',$limit_of_usage_time[1]);
                                                                if($limitTimeExplode2[0] == 1){
                                                                    echo '土曜 : '.Yii::app()->controller->__trans('Nothing');
                                                                }else if($limitTimeExplode2[0] == 2){
                                                                    echo '土曜： 制限有り('.$limitTimeExplode2[1].')';
                                                                }else if($limitTimeExplode2[0] == 3){
                                                                    echo '土曜 : '.Yii::app()->controller->__trans('unknown');
                                                                }else{
                                                                    echo '-';
                                                                }
                                                            }
                                                        ?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <?php
                                                            if(isset($limit_of_usage_time[2]) && count($limit_of_usage_time[2]) > 0){
                                                                $limitTimeExplode3 = explode('-',$limit_of_usage_time[2]);
                                                                if($limitTimeExplode3[0] == 1){
                                                                    echo '休日： '.Yii::app()->controller->__trans('Nothing');
                                                                }else if($limitTimeExplode3[0] == 2){
                                                                    echo '休日： 制限有り('.$limitTimeExplode3[1].')';
                                                                }else if($limitTimeExplode3[0] == 3){
                                                                    echo '休日： '.Yii::app()->controller->__trans('unknown');
                                                                }else{
                                                                    echo '-';
                                                                }
                                                            }
                                                        ?>
                                                    </td>
                                                </tr>
                                                <br/>

                                                <?php
                                                    }
                                                }
                                                if(isset($requestData['print_time_entrance'] ) == 1){
                                                ?>
                                                <tr>
                                                    <th rowspan="3">正面玄関</th>
                                                    <td>
                                                        <?php
                                                            $opTimeExp = $opTimeExplode = array();
                                                            if(isset($buildCart['ent_op_cl_time']) && $buildCart['ent_op_cl_time'] != ''){
                                                                $opTimeExp = explode(',',$buildCart['ent_op_cl_time']);
                                                                $opTimeExplode = explode('-',$opTimeExp[0]);
                                                                if($opTimeExplode[0] == 1){
                                                                    echo '平日： '.Yii::app()->controller->__trans('Nothing');
                                                                }else if($opTimeExplode[0] == 2){
                                                                    echo '平日： 制限有り('.$opTimeExplode[1].')';
                                                                }else if($opTimeExplode[0] == 3){
                                                                    echo '平日：'.Yii::app()->controller->__trans('unknown');
                                                                }else{
                                                                    echo '-';
                                                                }
                                                        ?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <?php
                                                            if(isset($opTimeExp[1]) && count($opTimeExp[1]) > 0){
                                                                $opTimeExplode2= explode('-',$opTimeExp[1]);
                                                                if($opTimeExplode2[0] == 1){
                                                                    echo '土曜 : '.Yii::app()->controller->__trans('Nothing');
                                                                }else if($opTimeExplode2[0] == 2){
                                                                    echo '土曜： 制限有り('.$opTimeExplode2[1].')';
                                                                }else if($opTimeExplode2[0] == 3){
                                                                    echo '土曜 : '.Yii::app()->controller->__trans('unknown');
                                                                }else{
                                                                    echo '-';
                                                                }
                                                            }
                                                        ?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>
                                                        <?php
                                                            if(isset($opTimeExp[2]) && count($opTimeExp[2])>0){
                                                                $opTimeExplode3= explode('-',$opTimeExp[2]);
                                                                if($opTimeExplode3[0] == 1){
                                                                    echo '休日： '.Yii::app()->controller->__trans('Nothing');
                                                                }else if($opTimeExplode3[0] == 2){
                                                                    echo '休日： 制限有り('.$opTimeExplode3[1].')';
                                                                }else if($opTimeExplode3[0] == 3){
                                                                    echo '休日：'.Yii::app()->controller->__trans('unknown');
                                                                }else{
                                                                    echo '-';
                                                                }
                                                            }
                                                        ?>
                                                    </td>
                                                        <?php
                                                            }
                                                    }
                                                    ?>
                                                </tr><br/>
                                            </table>
                                            <?php
                                            if($buildCart['exp_rent_disabled'] != 1){
                                                $expRent = array();
                                                if(isset($buildCart['exp_rent']) && $buildCart['exp_rent'] != ''){
                                                    $expRent = explode('-',$buildCart['exp_rent']);
                                                    if($expRent[0] != ""){
                                                        $expVal = explode('~',$expRent[0]);
                                                        if($expVal[0] != "" || $expVal[1] != ""){
                                            ?>
                                            <table class="summary memo">
                                                <caption>
                                                    備考
                                                </caption>
                                                <tr>
                                                    <th>見込賃料</th>
                                                    <td>
                                                        <?php														
                                                            if($expVal[0] != ""){
                                                                echo Yii::app()->controller->renderPrice($expVal[0]);
                                                                if($expVal[1] != ""){
                                                                    echo " ~";
                                                                }else{
                                                                    echo Yii::app()->controller->__trans('Yen');
                                                                }
                                                            }
                                                            if($expVal[1] != ""){
                                                                echo Yii::app()->controller->renderPrice($expVal[1]).Yii::app()->controller->__trans('Yen');
                                                            }
                                                            echo isset($expRent[1]) && $expRent[1] == 1 ? Yii::app()->controller->__trans('(Including common area charges)') : Yii::app()->controller->__trans('(Does not include common expenses)');
                                                        ?>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td colspan="2">
                                                        <?php														
                                                            if($buildCart['notes'] != ""){
																echo $buildCart['notes'];
															}
                                                        ?>
                                                    </td>
                                                </tr>
                                            </table>
                                            <?php
                                                        }
                                                    }
                                                }
                                            }
                                            ?>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                        <tr>
                            <td class="plan-img">
                                <?php
                                    $planPictureDetails = PlanPicture::model()->findAll('building_id = '.$buildCart['building_id'].' order by plan_picture_id desc');
									
                                    if(isset($planPictureDetails) && count($planPictureDetails) > 0){
										$latesPlan = array();
                                        foreach($planPictureDetails as $plan){
                                            $latesPlan[] = $plan->name;
                                        }
                                        //$latesPlan = end($latesPlan);
										
										$latesPlan = reset($latesPlan);
										
									}else{
                                        $latesPlan = 'no_plan.jpg';
                                    }
                                ?>
                                <img src="<?php echo Yii::app()->baseUrl.'/planPictures/'.$latesPlan; ?>" />
                            </td>
                        </tr>
                    </table>
                </section>
            <?php
			}
			elseif(count($floorDetails) > 9  && count($floorDetails)  <= 22 ) {}
			elseif(count($floorDetails)  > 22 ) {}
			$buildingNumber++;
		}
	}
	
	if(isset($requestData['print_map']) && $requestData['print_map'] == 1) {
	?>
    	<div id="map" class="sheet" style="width: 297mm; height: 1000px; page-break-after: always; position: relative;"></div>
        <script src="http://maps.google.com/maps/api/js?key=<?php echo $gApiKey; ?>&v=3" type="text/javascript"></script>
        <script src="<?php echo Yii::app()->request->baseUrl; ?>/js/markerwithlabel.js"></script>
        <style>
		.labels {
		    background: #fff;
			width: auto;
			height: auto;
			padding: 5px;
			text-align: center;
			line-height: 1em;
			font-size: 14px;
			color: #000;
			border: 5px solid red;
			font-weight: bold;
		}
		</style>
        <script type="text/javascript">
			var locations = <?php echo json_encode($array); ?>;
			var buildName = <?php echo json_encode($buildNameArray); ?>
			
			var map = new google.maps.Map(document.getElementById('map'), {
				zoom: 10,
				center: new google.maps.LatLng(36.6733301,135.2284552),
				mapTypeId: google.maps.MapTypeId.ROADMAP
			});
			
			var infowindow = new google.maps.InfoWindow();
			var marker, i;
			var image = '<?php echo Yii::app()->baseUrl.'/images/icon.png';?>';			
			
			var latlngbounds = new google.maps.LatLngBounds();
			
			//URL of Google Static Maps.
			var staticMapUrl = "https://maps.googleapis.com/maps/api/staticmap";
	 
			//Set the Google Map Center.
			staticMapUrl += "?center=" + 36.6733301 + "," + 135.2284552;
	 
			//Set the Google Map Size.
			staticMapUrl += "&size=220x350";
	 
			//Set the Google Map Zoom.
			staticMapUrl += "&zoom=" + 10;
	 
			//Set the Google Map Type.
			staticMapUrl += "&maptype=" + google.maps.MapTypeId.ROADMAP;
	 
			//Loop and add Markers.
			
			
			for (i = 0; i < locations.length; i++) { 
				console.log(buildName[i]);
				var splitLatLong = locations[i].split(',');
				var lat = splitLatLong[0];
				var long = splitLatLong[1];
				
				
				staticMapUrl += "&markers=color:red|" + lat + "," + long;
				
				
				/*var marker = new google.maps.Marker({
					position: new google.maps.LatLng(lat,long),
					map: map,
					label: { text: buildName[i] },
					labelContent: buildName[i],
					labelAnchor: new google.maps.Point(15, 65),
					labelClass: "labels", // the CSS class for the label
					labelInBackground: false,
					//label: buildName[i],
					icon: pinSymbol('red'),
					//icon: 'http://chart.apis.google.com/chart?chst='+buildName[i]+'&chld=' + k + '|FF0000|000000',
					//animation: google.maps.Animation.BOUNCE,
					//icon : image,
					visible: true
				});*/
				var marker = new MarkerWithLabel({
					position: new google.maps.LatLng(lat,long),
					map: map,
					labelContent: (i+1)+'. '+buildName[i],
					//labelAnchor: new google.maps.Point(lat,long),
					labelClass: "labels",
					//labelInBackground: false,
					//icon: image,
					icon: {},
					//animation: google.maps.Animation.BOUNCE,
					visible: true
				});
				
				/*marker.info = new google.maps.InfoWindow({
				  content: buildName[i],
				});
				
				google.maps.event.addListener(marker, 'click', function() {
				  marker.info.open(map, marker);
				});*/
				
				/*var iw = new google.maps.InfoWindow({
					content: buildName[i],
				});
				google.maps.event.addListener(marker, "click", function(e) {
					iw.open(map, this);
				});*/
				
				latlngbounds.extend(marker.position);
			}
			//Get the boundaries of the Map.
			var bounds = new google.maps.LatLngBounds();
			//Center map and adjust Zoom based on the position of all markers.
			map.setCenter(latlngbounds.getCenter());
			map.fitBounds(latlngbounds);
			marker.setMap(map);
		</script>
    <?php
	}
}
?>
</page>